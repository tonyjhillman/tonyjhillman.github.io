<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Creating and Editing Buckets | Couchbase Docs</title>
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Buckets can be created, and their configurations subsequently edited, with the REST API.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.2">
<meta name="page-url" content="/server/current/rest-api/rest-bucket-create.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/rest-api/pages/rest-bucket-create.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb">Reference</li>
<li class="crumb"><a href="rest-intro.html">REST API Reference</a></li>
<li class="crumb"><a href="rest-bucket-intro.html">Buckets API</a></li>
<li class="crumb"><a href="rest-bucket-create.html">Creating and Editing Buckets</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Creating and Editing Buckets</h1>
<div class="labels">
<ul><li class="reference"><span><i class="fas fa-book"></i></i> reference</span></li>
</ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Buckets can be created, and their configurations subsequently edited, with the REST API.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http-methods-and-uris"><a class="anchor" href="#http-methods-and-uris"></a>HTTP Methods and URIs</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>POST /pools/default/buckets

POST /pools/default/buckets/&lt;bucketName&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These respectively create a new bucket and edit an existing bucket.
The bucket can be of any type: Couchbase, Ephemeral, or Memcached.
(Note, however that Memcached buckets are now <em>deprecated</em>.)</p>
</div>
<div class="paragraph">
<p>On creation, a bucket must be assigned a name that is unique among buckets defined on the cluster: this name cannot subsequently be changed.
Names cannot be longer than 100 bytes (which is to say, characters).</p>
</div>
<div class="paragraph">
<p>A maximum of 30 buckets can be created on a single cluster.</p>
</div>
<div class="paragraph">
<p>Administrators with either the Full Admin or the Cluster Admin role can create buckets and edit their configurations.
Bucket configurations can also be edited by administrators with the Bucket Admin role, provided that its privileges have been extended either to all buckets on the cluster, or to the specific bucket whose configuration is to be edited.
See <a href="../learn/security/roles.html" class="xref page">Roles</a>, for information on roles and privileges.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="curl-syntax"><a class="anchor" href="#curl-syntax"></a>Curl Syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Note that floats and integers referred to in the following syntax-display are <em>non-negative</em> only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -X POST -u &lt;administrator&gt;:&lt;password&gt;
  http://&lt;ip-address-or-hostname&gt;:&lt;port&gt;/pools/default/buckets
  -d name=&lt;bucketName&gt;
  -d bucketType=[ couchbase | ephemeral | memcached ]
  -d ramQuota=&lt;integer&gt;
  -d storageBackend=[ couchstore | magma ]
  -d evictionPolicy=[
          [ valueOnly | full ] |
          [ noEviction | nruEviction ]
        ]
  -d durabilityMinLevel=[
          [ none | majority | majorityAndPersistActive | persistToMajority ] |
          [ none | majority ]
        ]
  -d threadsNumber=[ 3 | 8 ]
  -d replicaNumber=[ 1 | 2 | 3 ]
  -d compressionMode=[ off | passive | active ]
  -d maxTTL=&lt;integer&gt;
  -d replicaIndex=[ 0 | 1 ]
  -d conflictResolutionType=[ seqno | lww ]
  -d flushEnabled=[ 0 | 1 ]
  -d magmaKeyTreeDataBlockSize=&lt;integer&gt;
  -d magmaSeqTreeDataBlockSize=&lt;integer&gt;
  -d historyRetentionCollectionDefault=[ true | false ]
  -d historyRetentionBytes=&lt;integer&gt;
  -d historyRetentionSeconds=&lt;integer&gt;
  -d autoCompactionDefined=[ true | false ]
    -d parallelDBAndViewCompaction=[ true | false ]
    -d databaseFragmentationThreshold[percentage]=&lt;integer&gt;
    -d databaseFragmentationThreshold[size]=&lt;integer&gt;
    -d viewFragmentationThreshold[percentage]=&lt;integer&gt;
    -d viewFragmentationThreshold[size]=&lt;integer&gt;
    -d purgeInterval=[ &lt;float&gt; | &lt;integer&gt; ]
    -d allowedTimePeriod[fromHour]=&lt;integer&gt;
    -d allowedTimePeriod[fromMinute]=&lt;integer&gt;
    -d allowedTimePeriod[toHour]=&lt;integer&gt;
    -d allowedTimePeriod[toMinute]=&lt;integer&gt;
    -d allowedTimePeriod[abortOutside]=[ true | false ]</pre>
</div>
</div>
<div class="paragraph">
<p>All parameters are described in the following subsections.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parameter-groups"><a class="anchor" href="#parameter-groups"></a>Parameter Groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Parameters that support the creation and editing of buckets can be considered to form two groups; which are, respectively, <em>General</em> and <em>Auto-compaction</em>.</p>
</div>
<div class="sect2">
<h3 id="general"><a class="anchor" href="#general"></a>General</h3>
<div class="paragraph">
<p>Parameters in the <em>General</em> group include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Parameters that <em>must</em> be specified on bucket creation, these being:</p>
<div class="ulist">
<ul>
<li>
<p><a href="#ramQuota">ramQuota</a>, which establishes a memory-quota for the bucket, and <em>can</em> be edited following bucket creation.</p>
</li>
<li>
<p><a href="#name">name</a>, which establishes a name for the bucket, and <em>cannot</em> be edited following bucket creation.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Parameters that <em>can</em> be specified on bucket creation, but if not specified, acquire a default value.
They include:</p>
<div class="ulist">
<ul>
<li>
<p>Parameters that <em>can</em> be edited after bucket creation; these being <a href="#evictionpolicy">evictionPolicy</a>, <a href="#durabilityminlevel">durabilityMinLevel</a>, <a href="#threadsnumber">threadsNumber</a>, <a href="#replicanumber">replicaNumber</a>, <a href="#compressionmode">compressionMode</a>, <a href="#maxttl">maxTTL</a>, <a href="#flushenabled">flushEnabled</a>, <a href="#magmakeytreedatablocksize">magmaKeyTreeDataBlockSize</a>, <a href="#magmaseqtreedatablocksize">magmaSeqTreeDataBlockSize</a>,
<a href="#historyretentioncollectiondefault">historyRetentionCollectionDefault</a>,
<a href="#historyretentionbytes">historyRetentionBytes</a>, and
<a href="#historyretentionseconds">historyRetentionSeconds</a>.</p>
</li>
<li>
<p>Parameters that <em>cannot</em> be edited after bucket creation; these being <a href="#buckettype">bucketType</a>, <a href="#storagebackend">storageBackend</a>, <a href="#replicaindex">replicaIndex</a>, and <a href="#conflictresolutiontype">conflictResolutionType</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For full details and examples, see <a href="#general-parameters">General Parameters</a>, below.</p>
</div>
</div>
<div class="sect2">
<h3 id="auto-compaction"><a class="anchor" href="#auto-compaction"></a>Auto-Compaction</h3>
<div class="paragraph">
<p>Parameters in the <em>Auto-compaction</em> group support only <em>standard</em> storage: they are unnecessary for <em>memory-optimized</em> storage, and so are ignored, if explicitly specified when memory-optimized storage has been configured.
For information on index storage, see <a href="#learn:services-and-indexes/indexes/storage-modes.adoc" class="xref unresolved">Storage Settings</a>.</p>
</div>
<div class="paragraph">
<p><em>All</em> auto-compaction parameters can be edited, following bucket creation.</p>
</div>
<div class="paragraph">
<p>The Auto-compaction parameter group contains the following: <a href="#autocompactiondefined">autoCompactionDefined</a>, <a href="#paralleldbandviewcompaction">parallelDBAndViewCompaction</a>, <a href="#databasefragmentationthresholdpercentage">databaseFragmentationThreshold[percentage]</a>, <a href="#databasefragmentationthresholdsize">databaseFragmentationThreshold[size]</a>, <a href="#viewfragmentationthresholdpercentage">viewFragmentationThreshold[percentage]</a>, <a href="#viewfragmentationthresholdsize">viewFragmentationThreshold[size]</a>, <a href="#purgeinterval">purgeInterval</a>, <a href="#allowedtimeperiodfromhour">allowedTimePeriod[fromHour]</a>, <a href="#allowedtimeperiodfromminute">allowedTimePeriod[fromMinute]</a>, <a href="#allowedtimeperiodtohour">allowedTimePeriod[toHour]</a>, <a href="#allowedtimeperiodtominute">allowedTimePeriod[toMinute]</a>, and <a href="#allowedtimeperiodabortoutside">allowedTimePeriod[abortOutside]</a>.</p>
</div>
<div class="paragraph">
<p>Note that <em>Auto-compaction</em> parameters take effect only if both of the following are true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Auto-compaction is enabled, by means of the <a href="#autocompactiondefined">autoCompactionDefined</a> parameter.</p>
</li>
<li>
<p>An explicit setting is made to the <a href="#paralleldbandviewcompaction">parallelDBAndViewCompaction</a> parameter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For full details and examples, see <a href="#auto-compaction-parameters">Auto-Compaction Parameters</a>, below.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="general-parameters"><a class="anchor" href="#general-parameters"></a>General Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The parameters listed in the following subsections are all included in the <em>General</em> group, and therefore apply equally to Couchbase Server Enterprise and Community Editions.</p>
</div>
<div class="sect2">
<h3 id="name"><a class="anchor" href="#name"></a>name</h3>
<div class="paragraph">
<p>A name for a bucket that is to be created.
The name must be unique among the bucket-names defined for the cluster, and cannot be longer than 100 characters.
Acceptable characters are <code>A-Z</code>, <code>a-z</code>, and <code>0-9</code>.
Additionally, the <em>underscore</em>, <em>period</em>, <em>dash</em>, and <em>percent</em> characters can be used.</p>
</div>
<div class="paragraph">
<p>The name parameter <em>must</em> be specified, if a bucket is being created.
If it is not, or if the intended name is improperly designed, an error-notification is returned.
For example: : <code>{"name":"Bucket name needs to be specified"}</code>.
Note that a bucket-name <em>cannot</em> be changed after bucket-creation.
Therefore, if this parameter is specified in an attempt to edit the bucket-configuration, it is ignored.
To edit the configuration of an existing bucket, the bucket-name must be specified as the <code>&lt;bucketName&gt;</code> path-parameter; as indicated above, in <a href="#http-methods-and-uris">HTTP Methods and URIs</a>.</p>
</div>
<div class="sect3">
<h4 id="example-name-create"><a class="anchor" href="#example-name-create"></a>Example: Defining a New Name, When Creating</h4>
<div class="paragraph">
<p>In the following example, a bucket named <code>testBucket</code> is created, with a RAM-size of <code>256</code> MiB.
The bucket name is specified by means of the <code>name</code> parameter, with a value of <code>testBucket</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification, with empty content.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-name-edit"><a class="anchor" href="#example-name-edit"></a>Example: Referencing the Existing Name, When Editing</h4>
<div class="paragraph">
<p>To <em>edit</em> the bucket, the same endpoint is used, but with the bucket name specified as a concluding path-parameter, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d ramQuota=512</pre>
</div>
</div>
<div class="paragraph">
<p>The value of the <code>ramQuota</code> parameter (described below), is hereby increased to <code>512</code> MiB.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="buckettype"><a class="anchor" href="#buckettype"></a>bucketType</h3>
<div class="paragraph">
<p>Specifies the <em>type</em> of the bucket.
This can be <code>couchbase</code> (which is the default), <code>ephemeral</code>, or <code>memcached</code>.
For a detailed explanation of bucket types, see <a href="../learn/buckets-memory-and-storage/buckets.html" class="xref page">Buckets</a>.</p>
</div>
<div class="paragraph">
<p>If an invalid bucket type is specified, the error-notification <code>{"bucketType":"invalid bucket type"}</code> is returned.</p>
</div>
<div class="paragraph">
<p>This parameter <em>cannot</em> be modified, following bucket-creation.
If an attempt at modification is made, the parameter is ignored.</p>
</div>
<div class="sect3">
<h4 id="example-buckettype-create"><a class="anchor" href="#example-buckettype-create"></a>Example: Defining a Bucket Type, When Creating</h4>
<div class="paragraph">
<p>A bucket type can <em>only</em> be specified when the bucket is created: the specified type <em>cannot</em> be changed subsequently.</p>
</div>
<div class="paragraph">
<p>The following example creates a bucket, named <code>testBucket</code>, whose type is <em>ephemeral</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d bucketType=ephemeral</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ramQuota"><a class="anchor" href="#ramQuota"></a>ramQuota</h3>
<div class="paragraph">
<p>The amount of memory to be allocated to the bucket, per node, in MiB.
The minimum amount is 100 MiB.
The maximum amount is the total Data Service memory quota configured per node, minus the amount already assigned to other buckets.
For information on per node memory configuration, see the page for <a href="../manage/manage-settings/general-settings.html" class="xref page">General</a> Settings.</p>
</div>
<div class="paragraph">
<p>A value for <code>ramQuota</code> <em>must</em> be specified: the value <em>can</em> be modified, following bucket-creation.</p>
</div>
<div class="paragraph">
<p>An incorrect memory-specification returns a notification such as <code>{"ramQuota":"RAM quota cannot be less than 100 MiB"}</code>.</p>
</div>
<div class="sect3">
<h4 id="example-ramQuota-create"><a class="anchor" href="#example-ramQuota-create"></a>Example: Specifying a Memory Quota, when Creating</h4>
<div class="paragraph">
<p>The following example creates a Couchbase bucket, named <code>testBucket</code> and assigns it <code>256</code> MiB of memory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the bucket is of type <code>couchbase</code> by default.</p>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-ramQuota-edit"><a class="anchor" href="#example-ramQuota-edit"></a>Example: Specifying a New Memory Quota, when Editing</h4>
<div class="paragraph">
<p>The following example assigns a new memory quota, of <code>512</code> MiB, to the existing bucket <code>testBucket</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d ramQuota=512</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="storagebackend"><a class="anchor" href="#storagebackend"></a>storageBackend</h3>
<div class="paragraph">
<p>The <em>storage backend</em> to be assigned to and used by the bucket.
This can be either <code>couchstore</code> (which is the default) or <code>magma</code>.
For information, see <a href="../learn/buckets-memory-and-storage/storage-engines.html" class="xref page">Storage Engines</a>.</p>
</div>
<div class="sect3">
<h4 id="example-storage-backend"><a class="anchor" href="#example-storage-backend"></a>Example: Specifying the Storage Backend</h4>
<div class="paragraph">
<p>The storage backend can be specified only on bucket-creation.
A minimum of 1024 MiB is required if the <code>magma</code> option is used; a minimum of 100 MiB if the default <code>couchstore</code> is used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://127.0.0.1:8091/pools/default/buckets \
-u Administrator:password \
-d ramQuota=1024 \
-d storageBackend=magma \
-d name=testBucket</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="evictionpolicy"><a class="anchor" href="#evictionpolicy"></a>evictionPolicy</h3>
<div class="paragraph">
<p>The <em>ejection policy</em> to be assigned to and used by the bucket.
(Note that <em>eviction</em> is, in the current release, referred to as <em>ejection</em>; and this revised naming will continue to be used in future releases.)
Policy-assignment depends on bucket type.
For a <em>Couchbase</em> bucket, the policy can be <code>valueOnly</code> (which is the default) or <code>fullEviction</code>.
For an <em>Ephemeral</em> bucket, the policy can be <code>noEviction</code> (which is the default) or <code>nruEviction</code>.
No policy can be assigned to a <em>Memcached</em> bucket.</p>
</div>
<div class="paragraph">
<p>This value <em>can</em> be modified, following bucket-creation.
If such modification occurs, the bucket is restarted with the new setting: this may cause inaccessibility of data, during the bucket&#8217;s warm-up period.</p>
</div>
<div class="paragraph">
<p>Incorrect specification of an ejection policy returns an error-notification, such as <code>{"evictionPolicy":"Eviction policy must be either 'valueOnly' or 'fullEviction' for couchbase buckets"}</code>.</p>
</div>
<div class="paragraph">
<p>For information on ejection policies, see <a href="../learn/buckets-memory-and-storage/buckets.html#bucket-types" class="xref page">Bucket Types</a>.
For general information on memory management in the context of ejection, see <a href="../learn/buckets-memory-and-storage/memory.html#ejection" class="xref page">Ejection</a>.</p>
</div>
<div class="sect3">
<h4 id="example-evictionpolicy-create"><a class="anchor" href="#example-evictionpolicy-create"></a>Example: Specifying an Eviction Policy, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, which is a Couchbase bucket by default; and assigns it the <code>fullEviction</code> policy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket -d ramQuota=256 \
-d evictionPolicy=fullEviction</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-evictionpolicy-edit"><a class="anchor" href="#example-evictionpolicy-edit"></a>Example: Specifying a New Eviction Policy, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the eviction policy of the existing bucket <code>testBucket</code>, specifying that it should be <code>valueOnly</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d evictionPolicy=valueOnly</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="durabilityminlevel"><a class="anchor" href="#durabilityminlevel"></a>durabilityMinLevel</h3>
<div class="paragraph">
<p>A <em>durability level</em> to be assigned to the bucket, as the minimum level at which all writes to the bucket must occur.
Level-assignment depends on bucket type.
For a <em>Couchbase</em> bucket, the level can be <code>none</code>, <code>majority</code>, <code>majorityAndPersistActive</code>, or <code>persistToMajority</code>.
For an <em>Ephemeral</em> bucket, the level can be <code>none</code> or <code>majority</code>.
No level can be assigned to a <em>Memcached</em> bucket.</p>
</div>
<div class="paragraph">
<p>This parameter <em>can</em> be modified, following bucket-creation.</p>
</div>
<div class="paragraph">
<p>For information on durability and levels, see <a href="../learn/data/durability.html" class="xref page">Durability</a>.</p>
</div>
<div class="sect3">
<h4 id="example-durabilityminlevel-create"><a class="anchor" href="#example-durabilityminlevel-create"></a>Example: Specifying a Minimum Durability Level, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, which is a Couchbase bucket by default; and assigns it the minimum durability level of <code>majorityAndPersistActive</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d durabilityMinLevel=majorityAndPersistActive</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-durabilityminlevel-edit"><a class="anchor" href="#example-durabilityminlevel-edit"></a>Example: Specifying a New Minimum Durability Level, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the minimum durability level of the existing bucket <code>testBucket</code>, changing the level to <code>persistToMajority</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d durabilityMinLevel=persistToMajority</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="threadsnumber"><a class="anchor" href="#threadsnumber"></a>threadsNumber</h3>
<div class="paragraph">
<p>The <em>priority</em> for the bucket, as described in <a href="../manage/manage-buckets/create-bucket.html#bucket-priority" class="xref page">Create a Bucket</a>.
Priority can be established as either <em>Low</em> or <em>High</em>.
To establish priority as <em>Low</em> (which is the default), the value of <code>threadsNumber</code> must be <code>3</code>.
To establish priority as <em>High</em>, the value must be <code>8</code>.
If any other value is used, the value is ignored; and the bucket&#8217;s priority remains low.</p>
</div>
<div class="paragraph">
<p>If this parameter is incorrectly specified, an error-notification such as the following is returned: <code>{"threadsNumber":"The number of threads must be an integer between 2 and 8"}</code>.
(Note that, as indicated above, all values other than <code>3</code> and <code>8</code> are ignored.)</p>
</div>
<div class="paragraph">
<p>This parameter <em>can</em> be modified, following bucket-creation.
If such modification occurs, the bucket is restarted with the new setting: this may cause inaccessibility of data, during the bucket&#8217;s warm-up period.</p>
</div>
<div class="sect3">
<h4 id="example-threadsnumber-create"><a class="anchor" href="#example-threadsnumber-create"></a>Example: Specifying a Bucket Priority, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, which is a Couchbase bucket by default; and assigns it a <em>High</em> priority, by specifying <code>8</code> as the value to the <code>threadsNumber</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d threadsNumber=8</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-threadsnumber-edit"><a class="anchor" href="#example-threadsnumber-edit"></a>Example: Specifying a New Bucket Priority, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the priority of the existing bucket <code>testBucket</code>, changing the level to <em>Low</em>, by establishing <code>3</code> as the value of the <code>threadsNumber</code> parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d threadsNumber=3</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="replicanumber"><a class="anchor" href="#replicanumber"></a>replicaNumber</h3>
<div class="paragraph">
<p>The number of <em>replicas</em> for the bucket.
For information on replicas and replication, see <a href="../learn/clusters-and-availability/intra-cluster-replication.html" class="xref page">Intra-Cluster Replication</a> and <a href="../learn/buckets-memory-and-storage/vbuckets.html" class="xref page">vBuckets</a>.
The possible values are <code>0</code> (which <em>disables</em> replication, and therefore ensures that no replicas will be maintained), <code>1</code> (which is the default), <code>2</code>, and <code>3</code>.
If a number greater than <code>3</code> is specified, the following error-notification is returned: <code>{"replicaNumber":"Replica number larger than 3 is not supported."}</code>.</p>
</div>
<div class="paragraph">
<p>If more replicas are requested than can be assigned to the cluster, due to an insufficient number of nodes, no notification is returned. Instead, the maximum possible number of replicas is created: additional replicas will be added subsequently, if more nodes become available.</p>
</div>
<div class="paragraph">
<p>This parameter <em>can</em> be modified, following bucket-creation.
Such modification may require a rebalance: for information, see <a href="../learn/clusters-and-availability/rebalance.html" class="xref page">Rebalance</a>.</p>
</div>
<div class="sect3">
<h4 id="example-replicanumber-create"><a class="anchor" href="#example-replicanumber-create"></a>Example: Specifying a Number of Replicas, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, and specifies that it should have <code>3</code> replicas.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d replicaNumber=3</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-replicanumber-edit"><a class="anchor" href="#example-replicanumber-edit"></a>Example: Specifying a Modified Number of Replicas, when Editing</h4>
<div class="paragraph">
<p>The following example changes the replica-number of the existing bucket <code>testBucket</code>, specifying that the number be <code>2</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d replicaNumber=2</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="compressionmode"><a class="anchor" href="#compressionmode"></a>compressionMode</h3>
<div class="paragraph">
<p>The <em>compression mode</em> for the bucket.
The possible values are <code>off</code>, <code>passive</code> (which is the default), and <code>active</code>.
If the value is incorrectly specified, the following error-notification is returned: <code>{"compressionMode":"compressionMode can be set to 'off', 'passive' or 'active'"}</code>.</p>
</div>
<div class="paragraph">
<p>This parameter <em>can</em> be modified, following bucket-creation.</p>
</div>
<div class="paragraph">
<p>For information on compression and compression modes, see <a href="../learn/buckets-memory-and-storage/compression.html" class="xref page">Compression</a>.</p>
</div>
<div class="sect3">
<h4 id="example-compressionmode-creating"><a class="anchor" href="#example-compressionmode-creating"></a>Example: Specifying a Compression Mode, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, and assigns it the <code>active</code> compression mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d compressionMode=active</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-compressionmode-editing"><a class="anchor" href="#example-compressionmode-editing"></a>Example: Specifying a New Compression Mode, when Editing</h4>
<div class="paragraph">
<p>The following example changes the compression mode of the existing bucket <code>testBucket</code>, specifying that the mode now be <code>off</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d compressionMode=off</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="maxttl"><a class="anchor" href="#maxttl"></a>maxTTL</h3>
<div class="paragraph">
<p>The bucket&#8217;s <em>Time To Live</em> (TTL); which imposes a maximum lifespan on items within a bucket, and thus ensures the expiration of such items, once the specified period is complete.
The value must be an integer, which specifies a number of seconds.
The maximum value is MAX32INT (<code>2147483648</code> seconds, or <code>68.096</code> years).
The default value is <code>0</code>, which disables TTL for the bucket.
Specifying any positive value up to MAX32INT enables TTL for the bucket.
Specifying an incorrect value returns an error-notification such as the following: <code>{"maxTTL":"Max TTL must be an integer between 0 and 2147483647"}</code>.</p>
</div>
<div class="paragraph">
<p>This parameter <em>can</em> be modified, following bucket-creation.</p>
</div>
<div class="paragraph">
<p>For information on TTL, see <a href="../learn/data/expiration.html" class="xref page">Expiration</a>.</p>
</div>
<div class="sect3">
<h4 id="example-maxttl-create"><a class="anchor" href="#example-maxttl-create"></a>Example: Specifying a Time-to-Live Value, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, and assigns it a <em>time-to-live</em> of 500,000 seconds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d maxTTL=500000</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-maxttl-edit"><a class="anchor" href="#example-maxttl-edit"></a>Example: Specifying a New Time-to-Live value, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the <em>time-to-live</em> setting of the existing bucket <code>testBucket</code>, reducing it to <code>0</code>, and thereby <em>disabling</em> expiration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d maxTTL=0</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="replicaindex"><a class="anchor" href="#replicaindex"></a>replicaIndex</h3>
<div class="paragraph">
<p>Specifies whether <em>View Indexes</em> are to be replicated.
The value can be either <code>0</code> (which is the default), specifying that they are <em>not</em> to be replicated; or <code>1</code>, specifying that they <em>are</em> to be replicated.
Specifying any other value returns an error-notification such as the following: <code>{"replicaIndex":"replicaIndex can only be 1 or 0"}</code>.</p>
</div>
<div class="paragraph">
<p>This option is valid for Couchbase buckets only.
Note that there may be, at most, <em>one</em> replica view index.</p>
</div>
<div class="paragraph">
<p>This parameter <em>cannot</em> be modified, following bucket-creation.</p>
</div>
<div class="sect3">
<h4 id="example-replicaindex-create"><a class="anchor" href="#example-replicaindex-create"></a>Example: Specifying View Index Replication, when Creating</h4>
<div class="paragraph">
<p>View index replication can <em>only</em> be specified when a bucket is created.
Attempts to change the value subsequently are ignored.</p>
</div>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, and specifies that View indexes are to be replicated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d replicaIndex=1</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="conflictresolutiontype"><a class="anchor" href="#conflictresolutiontype"></a>conflictResolutionType</h3>
<div class="paragraph">
<p>Specifies the <em>conflict resolution type</em> for the bucket.
The value can be <code>seqno</code> (which is the default), specifying sequence-number based resolution; or <code>lww</code> (<em>last write wins</em>), specifying timestamp-based resolution
This parameter <em>cannot</em> be modified, following bucket-creation.
If modification is attempted, the following error-notification is returned: <code>{"conflictResolutionType":"Conflict resolution type not allowed in update bucket"}</code>.</p>
</div>
<div class="paragraph">
<p>For information on conflict resolution, see: <a href="../learn/clusters-and-availability/xdcr-conflict-resolution.html" class="xref page">XDCR Conflict Resolution</a>.</p>
</div>
<div class="sect3">
<h4 id="example-conflictresolutiontype-create"><a class="anchor" href="#example-conflictresolutiontype-create"></a>Example: Specifying a Conflict Resolution Policy, when Creating</h4>
<div class="paragraph">
<p>A bucket&#8217;s conflict resolution policy can <em>only</em> be specified when the bucket is created: attempts to change the setting subsequently are ignored.</p>
</div>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, specifying the <code>lww</code> conflict resolution policy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d conflictResolutionType=lww</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="flushenabled"><a class="anchor" href="#flushenabled"></a>flushEnabled</h3>
<div class="paragraph">
<p>Whether <em>flushing</em> is enabled for the bucket.
The value can be either <code>1</code>, which enables flushing; or <code>0</code>, which is the default, and disables flushing.</p>
</div>
<div class="paragraph">
<p>Flushing deletes <em>every</em> document in the bucket, and therefore should <em>not</em> be enabled unless absolutely necessary.</p>
</div>
<div class="paragraph">
<p>This parameter <em>can</em> be modified, following bucket-creation.</p>
</div>
<div class="sect3">
<h4 id="example-flushenabled-create"><a class="anchor" href="#example-flushenabled-create"></a>Example: Enable Flushing, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, and enables flushing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d flushEnabled=1</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-flushenabled-edit"><a class="anchor" href="#example-flushenabled-edit"></a>Example: Modify Flushing Enablement-Status, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the flushing enablement-status of the existing bucket, <code>testBucket</code>, switching it to <em>disabled</em>, by specifying the value <code>0</code> for the parameter <code>flushEnabled</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d flushEnabled=0</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="magmakeytreedatablocksize"><a class="anchor" href="#magmakeytreedatablocksize"></a>magmaKeyTreeDataBlockSize</h3>
<div class="paragraph">
<p>The block size, in bytes, for Magma <em>keyIndex</em> blocks.
The minimum block size that can be specified is 4096; and the maximum is 131072.
The default size is 4096.
The larger the specified block size, the better may be the block compression; potentially at the cost of greater consumption of memory, CPU, and I/O bandwidth.
Note that <code>storageBackend</code> must be <code>magma</code>.</p>
</div>
<div class="paragraph">
<p>This setting cannot be established or retrieved until the entire cluster is running 7.2 or higher.</p>
</div>
<div class="sect3">
<h4 id="example-magmakeytreedatablocksize-create"><a class="anchor" href="#example-magmakeytreedatablocksize-create"></a>Example: Set magmaKeyTreeDataBlockSize, when Creating</h4>
<div class="paragraph">
<p>The following example creates the bucket <code>testBucket</code>, establishing the value of <code>magmaKeyTreeDataBlockSize</code> as <code>7000</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=1100 \
-d storageBackend=magma \
-d magmaKeyTreeDataBlockSize=7000</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns <code>202 Accepted</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="magmaseqtreedatablocksize"><a class="anchor" href="#magmaseqtreedatablocksize"></a>magmaSeqTreeDataBlockSize</h3>
<div class="paragraph">
<p>The block size, in bytes, for Magma <em>seqIndex</em> blocks.
The minimum block size that can be specified is 4096; and the maximum is 131072.
The default size is 4096.
The larger the specified block size, the better may be the block compression; potentially at the cost of greater consumption of memory, CPU, and I/O bandwidth.
Note that <code>storageBackend</code> must be <code>magma</code>.</p>
</div>
<div class="paragraph">
<p>This setting cannot be established or retrieved until the entire cluster is running 7.2 or higher.</p>
</div>
<div class="sect3">
<h4 id="example-magmaseqtreedatablocksize-create"><a class="anchor" href="#example-magmaseqtreedatablocksize-create"></a>Example: Set magmaSeqTreeDataBlockSize, when Creating</h4>
<div class="paragraph">
<p>The following example creates the bucket <code>testBucket</code>, establishing the value of <code>magmaSeqTreeDataBlockSize</code> as <code>7000</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=1100 \
-d storageBackend=magma \
-d magmaSeqTreeDataBlockSize=7000</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns <code>202 Accepted</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="historyretentioncollectiondefault"><a class="anchor" href="#historyretentioncollectiondefault"></a>historyRetentionCollectionDefault</h3>
<div class="paragraph">
<p>Whether a change history is made for the bucket.
The change history records changes made to all collections within the bucket, and is written to disk continuously.
The value can be either <code>true</code> (the default) or <code>false</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored unless the value of <code>storageBackend</code> is specified as <code>magma</code>.
This parameter is also ignored unless a positive value is specified for either <code>historyRetentionSeconds</code> or <code>historyRetentionBytes</code>, or both.</p>
</div>
<div class="sect3">
<h4 id="example-flushenabled-create"><a class="anchor" href="#example-flushenabled-create"></a>Example: Enable historyRetentionCollectionDefault, when Creating</h4>
<div class="paragraph">
<p>The following example creates a bucket, specifies its storage as <em>magma</em>, and specifies that a record of changes made to collections within the bucket should <em>not</em> be made.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -X POST http://localhost:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=1100 \
-d storageBackend=magma \
-d historyRetentionCollectionDefault=false</pre>
</div>
</div>
<div class="paragraph">
<p>Success returns <code>202 Accepted</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-flushenabled-edit"><a class="anchor" href="#example-flushenabled-edit"></a>Example: Modify historyRetentionCollectionDefault, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the value of <code>historyRetentionCollectionDefault</code> for the existing bucket <code>testBucket</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://localhost:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d historyRetentionCollectionDefault=true</pre>
</div>
</div>
<div class="paragraph">
<p>Success returns <code>200 OK</code>.
Note, however, that this call only results in a change history being written to disk if <code>storageBackend</code> was specified as <code>magma</code> at bucket-creation, and if a positive value is specified (either prior to or after this call) for either <code>historyRetentionSeconds</code> or <code>historyRetentionBytes</code>, or for both.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="historyretentionbytes"><a class="anchor" href="#historyretentionbytes"></a>historyRetentionBytes</h3>
<div class="paragraph">
<p>Specifies the maximum size, in bytes, of the change history that is written to disk for all collections in this bucket when the value of <code>historyRetentionCollectionDefault</code> is <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Note that each replica configured for the bucket maintains a copy of the change history: therefore, if two replicas are configured, and the specified maximum size is 1,000,000 bytes, the total size used for the change history across the cluster becomes 3,000,000 bytes.</p>
</div>
<div class="paragraph">
<p>Note that for a change history to be written to disk, a positive value must be specified either for this parameter or for <code>historyRetentionSeconds</code>, or both.</p>
</div>
<div class="sect3">
<h4 id="example-flushenabled-create"><a class="anchor" href="#example-flushenabled-create"></a>Example: Set historyRetentionBytes, when Creating</h4>
<div class="paragraph">
<p>The following example creates a bucket, specifies its storage as <em>magma</em>, accepts the default value of <code>true</code> for <code>historyRetentionCollectionDefault</code>, and specifies the maximum disk-size of the change-record as 12,500,000 bytes.
Thus, when this size-limit is reached, the oldest key-value pairs in the current record will be successively removed, by means of compaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://localhost:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=1100 \
-d storageBackend=magma \
-d historyRetentionBytes=12500000</pre>
</div>
</div>
<div class="paragraph">
<p>Success returns <code>202 Accepted</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-flushenabled-edit"><a class="anchor" href="#example-flushenabled-edit"></a>Example: Modify historyRetentionBytes, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the value of <code>historyRetentionBytes</code> for the existing bucket <code>testBucket</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://localhost:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d historyRetentionBytes=12000000</pre>
</div>
</div>
<div class="paragraph">
<p>Success returns <code>200 OK</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="historyretentionseconds"><a class="anchor" href="#historyretentionseconds"></a>historyRetentionSeconds</h3>
<div class="paragraph">
<p>Specifies the maximum number of seconds to be covered by the change history that is written to disk for all collections in this bucket when the value of <code>historyRetentionCollectionDefault</code> is <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Note that for a change history to be written to disk, a positive value must be specified either for this parameter or for <code>historyRetentionBytes</code>, or both.</p>
</div>
<div class="sect3">
<h4 id="example-flushenabled-create"><a class="anchor" href="#example-flushenabled-create"></a>Example: Set historyRetentionSeconds, when Creating</h4>
<div class="paragraph">
<p>The following example creates a bucket, specifies its storage as <em>magma</em>, accepts the default value of <code>true</code> for <code>historyRetentionCollectionDefault</code>, and specifies the maximum number of seconds for the change-record as 13,600.
Thus, key-value pairs that have been recorded prior to 13,600 seconds before the current time will be removed, by means of compaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://localhost:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=1100 \
-d storageBackend=magma \
-d historyRetentionBytes=13600</pre>
</div>
</div>
<div class="paragraph">
<p>Success returns <code>202 Accepted</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-flushenabled-edit"><a class="anchor" href="#example-flushenabled-edit"></a>Example: Modify historyRetentionSeconds, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the number of seconds to be covered by the change history for the existing bucket <code>testBucket</code> to 11,000.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://localhost:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d historyRetentionSeconds=11000</pre>
</div>
</div>
<div class="paragraph">
<p>Success returns <code>200 OK</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="auto-compaction-parameters"><a class="anchor" href="#auto-compaction-parameters"></a>Auto-Compaction Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The parameters listed in the following subsections are all included in the <em>Auto-compaction</em> group</p>
</div>
<div class="sect2">
<h3 id="autocompactiondefined"><a class="anchor" href="#autocompactiondefined"></a>autoCompactionDefined</h3>
<div class="paragraph">
<p>Specifies whether the default <em>auto-compaction</em> settings are to be modified for this bucket.
The value specified can be either <code>true</code> or <code>false</code> (which is the default).
If the value is <code>false</code>, any parameter-values specified in order to modify the default auto-compaction settings are ignored.
If the value is incorrectly specified, an error-notification such as the following is returned: <code>{"autoCompactionDefined":"autoCompactionDefined is invalid"}</code>.</p>
</div>
<div class="paragraph">
<p>Note that if <code>autoCompactionDefined</code> is specified as <code>true</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All other auto-compaction-related parameters that need to be established should themselves be explicitly specified in the current call.</p>
</li>
<li>
<p>The parameter <code>parallelDBAndViewCompaction</code> <em>must</em> be defined.
If it is not defined, an error-notification such as the following is returned: <code>{"parallelDBAndViewCompaction":"parallelDBAndViewCompaction is missing"}</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Auto-compaction settings are unnecessary for <em>memory-optimized</em> indexes.
For information on index storage, see <a href="#learn:services-and-indexes/indexes/storage-modes.adoc" class="xref unresolved">Storage Settings</a>.</p>
</div>
<div class="paragraph">
<p>For further information on auto-compaction settings, see <a href="../manage/manage-settings/configure-compact-settings.html" class="xref page">Auto-Compaction</a>.</p>
</div>
<div class="sect3">
<h4 id="example-autocompactiondefined-create"><a class="anchor" href="#example-autocompactiondefined-create"></a>Example: Enabling Auto-Compaction, when Creating</h4>
<div class="paragraph">
<p>The following example creates a new bucket, named <code>testBucket</code>, and enables auto-compaction for the bucket.
Necessarily, a setting is also explicitly made for <code>parallelDBAndViewCompaction</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d autoCompactionDefined=true \
-d parallelDBAndViewCompaction=false</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-autocompactiondefined-edit"><a class="anchor" href="#example-autocompactiondefined-edit"></a>Example: Modifying Auto-Compaction Enablement, when Editing</h4>
<div class="paragraph">
<p>The following example changes the auto-compaction enablement of the existing bucket <code>testBucket</code>, <em>disabling</em> auto-compaction, by specifying the value <code>false</code> to the <code>autoCompactionDefined</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d autoCompactionDefined=false</pre>
</div>
</div>
<div class="paragraph">
<p>This disables auto-compaction for the bucket, and removes all auto-compaction-related settings.
If the call is successful, a <code>200 OK</code> notification is returned, with no object.</p>
</div>
<div class="paragraph">
<p>To <em>enable</em> auto-compaction after bucket creation, the <code>parallelDBAndViewCompaction</code> parameter must also be specified; as in the following example, which sets <code>parallelDBAndViewCompaction</code> to <code>false</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d autoCompactionDefined=true \
-d parallelDBAndViewCompaction=false</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>200 OK</code> notification.
No object is returned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="paralleldbandviewcompaction"><a class="anchor" href="#paralleldbandviewcompaction"></a>parallelDBAndViewCompaction</h3>
<div class="paragraph">
<p>Specifies whether compaction should occur to documents and view indexes in parallel.
This is a <em>global</em> setting, which therefore affects <em>all</em> buckets on the cluster.
The value can either be <code>true</code> or <code>false</code>: one value or the other <em>must</em> be specified.
If the value is incorrectly specified, the following error-notification is returned: <code>{"parallelDBAndViewCompaction":"parallelDBAndViewCompaction is invalid"}</code>.</p>
</div>
<div class="paragraph">
<p>This parameter-value is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>For examples, see <a href="#autocompactiondefined">autoCompactionDefined</a>, above.</p>
</div>
</div>
<div class="sect2">
<h3 id="databasefragmentationthresholdpercentage"><a class="anchor" href="#databasefragmentationthresholdpercentage"></a>databaseFragmentationThreshold[percentage]</h3>
<div class="paragraph">
<p>Specifies, as a percentage, the level of database fragmentation that must be reached for data compaction to be automatically triggered.
The assigned value must be an integer from <code>0</code> to <code>100</code>.
The default value is <code>"undefined"</code>.</p>
</div>
<div class="paragraph">
<p>If a value for <code>databaseFragmentationThreshold[size]</code> is also specified, data compaction is automatically triggered as soon as the threshold specified by one parameter or the other is reached.</p>
</div>
<div class="paragraph">
<p>If this parameter is incorrectly specified, an error-notification such as the following is returned: <code>"databaseFragmentationThreshold[percentage]":"database fragmentation must be an integer"</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="sect3">
<h4 id="example-databasefragmentationthresholdpercentage-create"><a class="anchor" href="#example-databasefragmentationthresholdpercentage-create"></a>Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</h4>
<div class="paragraph">
<p>The following example establishes a value for <code>databaseFragmentationThreshold[percentage]</code>, and for all other auto-compaction-related parameters, in its creation of a new bucket, named <code>testBucket</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets \
-u Administrator:password \
-d name=testBucket \
-d ramQuota=256 \
-d autoCompactionDefined=true \
-d parallelDBAndViewCompaction=false \
-d databaseFragmentationThreshold[percentage]=30 \
-d databaseFragmentationThreshold[size]=1073741824 \
-d viewFragmentationThreshold[percentage]=30 \
-d viewFragmentationThreshold[size]=1073741824 \
-d allowedTimePeriod[fromHour]=0 \
-d allowedTimePeriod[fromMinute]=0 \
-d allowedTimePeriod[toHour]=6 \
-d allowedTimePeriod[toMinute]=0 \
-d allowedTimePeriod[abortOutside]=true \
-d purgeInterval=3.0</pre>
</div>
</div>
<div class="paragraph">
<p>The data fragmentation threshold percentage is hereby specified as <code>30</code>.</p>
</div>
<div class="paragraph">
<p>If successful, the call returns a <code>202 Accepted</code> notification.
No object is returned.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-databasefragmentationthresholdpercentage-edit"><a class="anchor" href="#example-databasefragmentationthresholdpercentage-edit"></a>Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</h4>
<div class="paragraph">
<p>The following example modifies the <code>databaseFragmentationThreshold[percentage]</code> setting for the existing bucket <code>testBucket</code>; establishing a new value of <code>47</code>.
Note that although other auto-compaction settings are intended to be unchanged from their previous, explicit settings, all <em>must be respecified</em> correspondingly in the new call: otherwise, all revert to their default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST http://10.143.201.101:8091/pools/default/buckets/testBucket \
-u Administrator:password \
-d autoCompactionDefined=true \
-d parallelDBAndViewCompaction=false \
-d databaseFragmentationThreshold[percentage]=47 \
-d databaseFragmentationThreshold[size]=1073741824 \
-d viewFragmentationThreshold[percentage]=30 \
-d viewFragmentationThreshold[size]=1073741824 \
-d allowedTimePeriod[fromHour]=0 \
-d allowedTimePeriod[fromMinute]=0 \
-d allowedTimePeriod[toHour]=6 \
-d allowedTimePeriod[toMinute]=0 \
-d allowedTimePeriod[abortOutside]=true \
-d purgeInterval=3.0</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="databasefragmentationthresholdsize"><a class="anchor" href="#databasefragmentationthresholdsize"></a>databaseFragmentationThreshold[size]</h3>
<div class="paragraph">
<p>Specifies, as a size in MiB, the level of database fragmentation that must be reached for data compaction to be automatically triggered.
The assigned value must be a positive integer.
The default value is <code>"undefined"</code>.</p>
</div>
<div class="paragraph">
<p>If a value for <code>databaseFragmentationThreshold[percentage]</code> is also specified, data compaction is automatically triggered as soon as the threshold specified by one parameter or the other is reached.</p>
</div>
<div class="paragraph">
<p>If this parameter is incorrectly specified, an error-notification such as the following is returned: <code>"databaseFragmentationThreshold[size]":"database fragmentation must be an integer"</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="viewfragmentationthresholdpercentage"><a class="anchor" href="#viewfragmentationthresholdpercentage"></a>viewFragmentationThreshold[percentage]</h3>
<div class="paragraph">
<p>Specifies, as a percentage, the level of View fragmentation that must be reached for View compaction to be automatically triggered.
The assigned value must be an integer from <code>0</code> to <code>100</code>.
The default value is <code>"undefined"</code>.</p>
</div>
<div class="paragraph">
<p>If a value for <code>viewFragmentationThreshold[size]</code> is also specified, View compaction is automatically triggered as soon as the threshold specified by one parameter or the other is reached.</p>
</div>
<div class="paragraph">
<p>If this parameter is incorrectly specified, an error-notification such as the following is returned: <code>"viewFragmentationThreshold[percentage]":"view fragmentation must be an integer"</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="viewfragmentationthresholdsize"><a class="anchor" href="#viewfragmentationthresholdsize"></a>viewFragmentationThreshold[size]</h3>
<div class="paragraph">
<p>Specifies, as a size in MiB, the level of View fragmentation that must be reached for View compaction to be automatically triggered.
The assigned value must be a positive integer.
The default value is <code>"undefined"</code>.</p>
</div>
<div class="paragraph">
<p>If a value for <code>viewFragmentationThreshold[percentage]</code> is also specified, View compaction is automatically triggered as soon as the threshold specified by one parameter or the other is reached.</p>
</div>
<div class="paragraph">
<p>If this parameter is incorrectly specified, an error-notification such as the following is returned: <code>"viewFragmentationThreshold[size]":"view fragmentation size must be an integer"</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="purgeinterval"><a class="anchor" href="#purgeinterval"></a>purgeInterval</h3>
<div class="paragraph">
<p>Specifies the tombstone (or metadata) purge interval.
The value can be either an integer (indicating a number of days), or a float (indicating an interval that may be greater or less than one day, and entails a number of hours, with <code>0.04</code> indicating <em>one hour</em>).
The default value is three days.</p>
</div>
<div class="paragraph">
<p>If this parameter is incorrectly specified, an error-notification such as the following is returned: <code>{"purgeInterval":"metadata purge interval must be a number"}</code>.</p>
</div>
<div class="paragraph">
<p>For more information see <a href="../manage/manage-settings/configure-compact-settings.html#tombstone-purge-interval" class="xref page">Tombstone Purge Interval</a> and <a href="../learn/buckets-memory-and-storage/storage-settings.html" class="xref page">Storage</a>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="allowedtimeperiodfromhour"><a class="anchor" href="#allowedtimeperiodfromhour"></a>allowedTimePeriod[fromHour]</h3>
<div class="paragraph">
<p>The starting hour of the time-period during which auto-compaction is permitted to run.
The value must be an integer.
The default value is <code>0</code>.
If the value is incorrectly specified, an error-notification such as either of the following is returned: <code>{"allowedTimePeriod[fromHour]":"from hour must be an integer"}</code> , <code>{"allowedTimePeriod[fromHour]":"from hour is too large. Allowed range is 0 - 59"}</code>..</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
</div>
<div class="sect2">
<h3 id="allowedtimeperiodfromminute"><a class="anchor" href="#allowedtimeperiodfromminute"></a>allowedTimePeriod[fromMinute]</h3>
<div class="paragraph">
<p>The starting minute of the time-period during which auto-compaction is permitted to run.
The value must be an integer.
The default value is <code>0</code>.
If the value is incorrectly specified, an error-notification such as either of the following is returned: <code>{"allowedTimePeriod[fromMinute]":"from minute must be an integer"}</code>, <code>{"allowedTimePeriod[fromMinute]":"from minute is too large. Allowed range is 0 - 59"}</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="allowedtimeperiodtohour"><a class="anchor" href="#allowedtimeperiodtohour"></a>allowedTimePeriod[toHour]</h3>
<div class="paragraph">
<p>The ending hour of the time-period during which auto-compaction is permitted to run.
The value must be an integer.
The default value is <code>0</code>.
If the value is incorrectly specified, an error-notification such as either of the following is returned: <code>{"allowedTimePeriod[fromHour]":"to hour must be an integer"}</code>, <code>{"allowedTimePeriod[toHour]":"to hour is too large. Allowed range is 0 - 59"}</code>.</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="allowedtimeperiodtominute"><a class="anchor" href="#allowedtimeperiodtominute"></a>allowedTimePeriod[toMinute]</h3>
<div class="paragraph">
<p>The ending minute of the time-period during which auto-compaction is permitted to run.
The value must be an integer.
The default value is <code>0</code>.
If the value is incorrectly specified, an error-notification such as either of the following is returned: <code>{"allowedTimePeriod[toMinute]":"to minute must be an integer"}</code>, <code>{"allowedTimePeriod[toMinute]":"to minute is too large. Allowed range is 0 - 59"}</code>.</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="allowedtimeperiodabortoutside"><a class="anchor" href="#allowedtimeperiodabortoutside"></a>allowedTimePeriod[abortOutside]</h3>
<div class="paragraph">
<p>Specifies whether compaction can be aborted if the specified time-period is exceeded.
The value must be either <code>true</code> or <code>false</code> (which is the default).</p>
</div>
<div class="paragraph">
<p>This parameter is ignored if <code>autoCompactionDefined</code> is <code>false</code> (which is its default value).</p>
</div>
<div class="paragraph">
<p>See the examples provided above, in <a href="#example-databasefragmentationthresholdpercentage-create">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Creating</a> and <a href="#example-databasefragmentationthresholdpercentage-edit">Example: Specifying a Data Fragmentation Threshold as a Percentage, when Editing</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="responses"><a class="anchor" href="#responses"></a>Responses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If bucket-creation is successful, HTTP response <code>202 Accepted</code> is returned, with empty content.
If bucket-editing is successful, HTTP response <code>200 OK</code> is returned, with empty content.
If the bucket cannot created due to a missing or incorrect parameter, a <code>400</code> response is returned, with a JSON payload containing the reason for the error (errors are described per parameter, in the sections above).</p>
</div>
<div class="paragraph">
<p>If the URL is incorrectly specified a <code>404 (Object Not Found)</code> error is returned.
Failure to authenticate gives <code>401 Unauthorized</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A conceptual description of buckets is provided in <a href="../learn/buckets-memory-and-storage/buckets.html" class="xref page">Buckets</a>.
Options for managing buckets with Couchbase Web Console are provided in <a href="../manage/manage-buckets/bucket-management-overview.html" class="xref page">Manage Buckets</a>.
For information on the Couchbase CLI command <code>bucket-create</code>, see the reference page for <a href="#cli:cbcli/couchbase-cli-bucket-create.adoc" class="xref unresolved">bucket-create</a>.</p>
</div>
<div class="paragraph">
<p>Information on memory-management options for Couchbase Server is provided in For information on index storage, see <a href="#learn:services-and-indexes/indexes/storage-modes.adoc" class="xref unresolved">Storage Settings</a>.
Information on auto-compaction settings is provided in <a href="../manage/manage-settings/configure-compact-settings.html" class="xref page">Auto-Compaction</a>.</p>
</div>
<div class="paragraph">
<p>Information on other, Couchbase-Server key concepts can be found as follows: for durability, in <a href="../learn/data/durability.html" class="xref page">Durability</a>; for expiration (<em>time-to-live</em>), in <a href="../learn/data/expiration.html" class="xref page">Expiration</a>; for ejection, in <a href="../learn/buckets-memory-and-storage/memory.html" class="xref page">Memory</a>; for replication, in <a href="../learn/clusters-and-availability/intra-cluster-replication.html" class="xref page">Intra-Cluster Replication</a>; for compression, in <a href="../learn/buckets-memory-and-storage/compression.html" class="xref page">Compression</a>; for conflict resolution, in <a href="../learn/clusters-and-availability/xdcr-conflict-resolution.html" class="xref page">XDCR Conflict Resolution</a>; for purging, in <a href="../manage/manage-settings/configure-compact-settings.html#tombstone-purge-interval" class="xref page">Tombstone Purge Interval</a>.</p>
</div>
<div class="paragraph">
<p>See <a href="../learn/security/roles.html" class="xref page">Roles</a>, for information on roles and privileges.</p>
</div>
<div class="paragraph">
<p>For information on how to inspect a bucket&#8217;s current configuration, see <a href="rest-buckets-summary.html" class="xref page">Getting All Bucket Information</a>.</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span> 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
