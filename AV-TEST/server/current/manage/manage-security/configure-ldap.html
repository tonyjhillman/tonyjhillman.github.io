<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Configure LDAP | Couchbase Docs</title>
<link rel="stylesheet" href="../../../../_/css/site.css">
<script src="../../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Couchbase Server can be configured to authenticate users by means of LDAP; and to map the LDAP &lt;em&gt;groups&lt;/em&gt; of which a user is a member to roles defined on Couchbase Server.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.2">
<meta name="page-url" content="/server/current/manage/manage-security/configure-ldap.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/manage/pages/manage-security/configure-ldap.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb">Manage</li>
<li class="crumb"><a href="security-management-overview.html">Manage Security</a></li>
<li class="crumb"><a href="manage-authentication.html">Manage Authentication</a></li>
<li class="crumb"><a href="configure-ldap.html">Configure LDAP</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Configure LDAP</h1>
<div class="labels">
<ul></ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Couchbase Server can be configured to authenticate users by means of LDAP; and to map the LDAP <em>groups</em> of which a user is a member to roles defined on Couchbase Server.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="understanding-ldap-authentication"><a class="anchor" href="#understanding-ldap-authentication"></a>Understanding LDAP Authentication and Authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For authentication purposes, Couchbase Server can be configured to use LDAP.
This allows users, when they attempt to access Couchbase Server by presenting their credentials, to be authenticated by LDAP.
Optionally, LDAP <em>group</em> information for the authenticated user can be fetched from the LDAP server.
If an LDAP group has been mapped to Couchbase-Server roles, the roles are thereby granted to the user.</p>
</div>
<div class="paragraph">
<p>Note that LDAP authentication and authorization may be more appropriate for human users than for applications.
For information, see <a href="../../learn/security/authentication-domains.html#ldap-users-and-applications" class="xref page">LDAP: Users and Applications</a>.</p>
</div>
<div class="paragraph">
<p>Note that Couchbase Server provides two different ways of setting up LDAP:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Native LDAP Support</em>.
For Couchbase Server Enterprise Edition 6.5+, this is the recommended way of setting up LDAP for external authentication.
It provides support for encrypted communication, and for LDAP groups.</p>
</li>
<li>
<p><em>LDAP Support Based on</em> <code>saslauthd</code>.
This is maintained for support of legacy LDAP authentication (as established on pre-6.5 versions of Couchbase Server), and for support of PAM-based authentication.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This page provides examples of how to configure <em>Native LDAP Support</em>.
For information on configuring <code>saslauthd</code>, see <a href="configure-saslauthd.html" class="xref page">Configure <code>saslauthd</code></a>.
For an overview of Couchbase authentication, and more details on external-authentication options, see <a href="../../learn/security/authentication-domains.html" class="xref page">Authentication Domains</a>.</p>
</div>
<div class="paragraph">
<p>Note that <em>either</em> Native LDAP Support <em>or</em> <code>saslauthd</code> must be selected for the cluster.
The two cannot be used simultaneously.</p>
</div>
<div class="paragraph">
<p>Note also that <em>both</em> Native LDAP Support <em>and</em> <code>saslauthd</code> require clients to use the PLAIN authentication mechanism, ideally with TLS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migrating-to-native-ldap"><a class="anchor" href="#migrating-to-native-ldap"></a>Migrating to Native LDAP</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have been using <code>saslauthd</code> with previous versions of Couchbase Server, you are strongly recommended to migrate to <em>Native LDAP</em>.
The overall migration procedure is provided as part of the <code>saslauthd</code> documentation, in <a href="configure-saslauthd.html#migrating-from-saslauthd-to-native-ldap" class="xref page">Migrating from saslauthd to Native LDAP</a>.
Note that the migration procedure itself involves some of the procedures given on the current page, below.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples-on-this-page-node-addition"><a class="anchor" href="#examples-on-this-page-node-addition"></a>Examples on This Page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The examples in the subsections below show how to configure Native LDAP Support; using the <a href="#configure-ldap-with-the-ui">UI</a>, the <a href="#configure-ldap-with-the-cli">CLI</a>, and the <a href="#configure-ldap-with-the-rest-api">REST API</a> respectively.
The examples assume:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A one-node cluster already exists; and is named after its IP address: <code>10.143.192.101</code>.
It is running the Data and Query Services, and has the <code>travel-sample</code> bucket installed.
(To install this bucket, see <a href="../manage-settings/install-sample-buckets.html" class="xref page">Sample Buckets</a>.)</p>
</li>
<li>
<p>The cluster has the Full Administrator username of <code>Administrator</code>, and password of <code>password</code>.</p>
</li>
<li>
<p>Two fully configured LDAP servers are available, at <code>172.23.124.25</code> and <code>172.23.124.26</code>, each using port <code>389</code>.</p>
</li>
<li>
<p>External authentication for the cluster has been enabled.
This can be achieved by means of the Couchbase CLI command, <code>setting-ldap</code>, as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">/opt/couchbase/bin/couchbase-cli setting-ldap \
-c 10.144.210.101 -u Administrator -p password \
--authentication-enabled 1</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each subsection also shows how to map LDAP groups to Couchbase-Server roles, by means of Couchbase-Server user-groups.</p>
</div>
<div class="paragraph">
<p>Throughout this page, references are made to LDAP <em>Distinguished Names</em>, which must be specified as part of Native-LDAP configuration.
For the full definition of Distinguished Names, see <a href="https://tools.ietf.org/html/rfc4514" target="_blank" rel="noopener">RFC 4514 - Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-ldap-with-the-ui"><a class="anchor" href="#configure-ldap-with-the-ui"></a>Configure LDAP with the UI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure LDAP, access the <strong>Security</strong> panel, by means of the entry in the left-hand navigation bar:</p>
</div>
<div id="security-tab" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/securityTab.png" alt="securityTab" width="100">
</div>
</div>
<div class="paragraph">
<p>This brings up the <strong>Security</strong> screen.
Note the options at the upper right:</p>
</div>
<div id="ldap-and-groups-tabs" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/ldapAndGroupsTabs.png" alt="ldapAndGroupsTabs" width="720">
</div>
</div>
<div class="paragraph">
<p>The <strong>LDAP</strong> tab allows an LDAP server to be specified for external authentication.
The <strong>ADD GROUP</strong> tab allows definition of <em>Couchbase-Server user-groups</em>; which are to be associated with <em>LDAP groups</em>, and which can be assigned Couchbase-Server <em>roles</em>.
The <strong>ADD USER</strong> tab allows individual users to be added, and allows their authentication optionally to be specified as <strong>external</strong>.</p>
</div>
<div class="paragraph">
<p>To perform LDAP configuration, left-click on the <strong>LDAP</strong> tab, at the upper right of the <strong>Security</strong> screen:</p>
</div>
<div id="left-click-on-ldap-tab" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/leftClickOnLdapTab.png" alt="leftClickOnLdapTab" width="70">
</div>
</div>
<div class="paragraph">
<p>This brings up the <strong>LDAP Configuration</strong> dialog:</p>
</div>
<div id="configure-ldap-dialog" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/configureLDAP2.png" alt="configureLDAP2" width="420">
</div>
</div>
<div class="paragraph">
<p>The dialog presents two main panels.
The vertically scrollable right panel features help text, for <strong>LDAP Host Configuration</strong>, <strong>User Authentication</strong>, and <strong>Group Authorization</strong>.
The left panel features options whereby LDAP can be configured.</p>
</div>
<div class="paragraph">
<p>The fields of the left panel are presented in three principal areas, each corresponding to a key aspect of LDAP configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>LDAP host configuration</em>.
These fields occupy the upper part of the left panel.
They can be used to establish which servers run LDAP, and how they are to be contacted.</p>
</li>
<li>
<p><em>User authentication enablement</em>.
These fields can be accessed in the lower part of the left panel, by means of the <strong>Enable LDAP user authentication</strong> switch.
They can be used to establish that users not recognized as <em>local</em> to Couchbase Server will be authenticated by means of the specified <em>LDAP host configuration</em>, and to specify the procedures to be used.</p>
</li>
<li>
<p><em>Group authorization enablement</em>.
These fields can be accessed from near the bottom of the left panel, by means of the <strong>Enable LDAP group authorization &amp; sync</strong> switch.
They can be used to establish that the LDAP group-membership of authenticated LDAP users will be checked, to determine whether mappings to Couchbase-Server user-groups exist, and to specify the procedures to be used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these areas is described below.</p>
</div>
<div class="sect2">
<h3 id="ldap-host-configuration"><a class="anchor" href="#ldap-host-configuration"></a>LDAP Host Configuration</h3>
<div class="paragraph">
<p>The upper area of the left panel of the <strong>LDAP Configuration</strong> dialog displays the following fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>LDAP Host(s)</strong>. A comma-separated list of host-names, each of which is an LDAP server on which external authentication can occur.
The first accessible server in the list is the one that is used.
For example, if the list is <code>server1, server2</code>, provided that <code>server1</code> is accessible, it is used.</p>
</li>
<li>
<p><strong>LDAP Port</strong>. The port used on each of the LDAP servers for authentication.</p>
</li>
</ul>
</div>
<div id="encryption-pulldown-menu" class="ulist">
<ul>
<li>
<p><strong>Encryption</strong>. Whether the connection with the LDAP server should be encrypted.
Note that use of encryption is <em>strongly</em> recommended.</p>
<div class="paragraph">
<p>Left-click on the control at the right-hand side of the <strong>Encryption</strong> field, to display the pull-down menu:</p>
</div>
<div id="encryption-pull-down-menu" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/configureLDAPencryptionPullDownMenu.png" alt="configureLDAPencryptionPullDownMenu" width="170">
</div>
</div>
<div class="paragraph">
<p>The options are <strong>None</strong> (to connect without encryption &#8212; this is insecure, and therefore is <em>not</em> recommended), <strong>TLS</strong> (to connect to a TLS-encrypted port), and <strong>StartTLSExtension</strong> (to upgrade an existing connection).</p>
</div>
</li>
<li>
<p><strong>Certificate</strong>. Whether to provide Couchbase Server with a copy of the LDAP server&#8217;s root certificate, so as to allow Couchbase Server to validate the LDAP server when connecting.
This set of radio-buttons is enabled only if <strong>TLS</strong> or <strong>StartTLSExtension</strong> has been selected from the <a href="#encryption-pulldown-menu">Encryption</a> pull-down menu.</p>
<div class="paragraph">
<p>The options are <strong>None</strong>, <strong>Couchbase</strong>, and <strong>Paste Cert</strong>.
If <strong>None</strong> is selected, the LDAP server&#8217;s root certificate is <em>not</em> provided to Couchbase Server: this option is insecure, and therefore <em>not</em> recommended.</p>
</div>
<div class="paragraph">
<p>If <strong>Couchbase</strong> is selected, the root certificate for the Couchbase-Server cluster is used to validate the LDAP server: this assumes that the same root certificate is installed for both Couchbase Server and the LDAP server.</p>
</div>
<div class="paragraph">
<p><strong>Paste Cert</strong> should be selected if the LDAP server root certificate is <em>not</em> the same certificate as has been installed for the Couchbase-Server cluster.
When <strong>Paste Cert</strong> is selected, the panel expands vertically, to reveal the <strong>LDAP Server Root Certificate</strong> field:</p>
</div>
<div id="certificate-text-field" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/certificateTextField.png" alt="certificateTextField" width="400">
</div>
</div>
<div class="paragraph">
<p>The text of the LDAP server root certificate should now be copied and pasted, in PEM format, into the <strong>LDAP Server Root Certificate</strong> field.</p>
</div>
</li>
<li>
<p><strong>Contact LDAP host</strong>.
The following options are provided, to determine how Couchbase Server will contact the LDAP host.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Anonymously</strong>.
Checking this checkbox causes Couchbase Server to attempt to contact the LDAP host anonymously.
However, the attempt succeeds only if supported by the LDAP server.</p>
</li>
<li>
<p><strong>Credentials</strong>.
Checking this checkbox allows credentials to be specified by the user, and submitted to the LDAP host for authentication.
The UI expands, to display two additional fields:</p>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/contactLDAPhostCredentials.png" alt="contactLDAPhostCredentials" width="450">
</div>
</div>
<div class="paragraph">
<p><strong>Bind DN</strong> requires the LDAP <em>Distinguished Name</em> of the user who will perform user-search and groups synchronization.
This user needs to have <em>read only</em> access to the LDAP server, in order to be able to search for users and groups.</p>
</div>
<div class="paragraph">
<p><strong>Password</strong> requires input of the user&#8217;s password, as stored on the LDAP server.</p>
</div>
<div class="paragraph">
<p>With data entered into these fields, the dialog might appear as follows:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/configureLDAPhalfComplete.png" alt="configureLDAPhalfComplete" width="520">
</div>
</div>
</li>
<li>
<p><strong>Client Certificate</strong>.
This option, which allows allows Couchbase Server to authenticate with LDAP by means of a client certificate, should be used only with an LDAP server that <em>does not</em> expect the <code>SASL EXTERNAL</code> bind command to be sent, once a TLS connection has been established.
Note, therefore, that this option <em>can</em> be used with the <em>GSuite</em> LDAP server.</p>
<div class="paragraph">
<p>This option is only enabled if either <strong>TLS</strong> or <strong>StartTLSExtension</strong> has been selected from the <a href="#encryption-pulldown-menu">Encryption</a> pull-down menu.</p>
</div>
<div class="paragraph">
<p>When the <strong>Client Certificate</strong> option is selected, the UI expands as follows:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/contactLDAPhostClientCertificate.png" alt="contactLDAPhostClientCertificate" width="520">
</div>
</div>
<div class="paragraph">
<p>The client certificate of Couchbase Server should be pasted into the <strong>Client Certificate</strong> panel.
The <em>private key</em> corresponding to the client certificate should be pasted into the <strong>Client Key</strong> panel.
These files can be selected by means of the <strong>Select File</strong> buttons, which bring up a file-selection interface.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once all appropriate settings have been made to <strong>LDAP Host(s)</strong>, <strong>Encryption</strong>, <strong>Certificate</strong>, and <strong>Contact LDAP host</strong> fields, optionally, the <strong>Check Network Settings</strong> button can be left-clicked on.
This tests whether a specified LDAP host can be accessed by the specified means.
If no such access is possible, an error is displayed on the dialog.</p>
</div>
</div>
<div class="sect2">
<h3 id="enable-ldap-user-authentication"><a class="anchor" href="#enable-ldap-user-authentication"></a>User Authentication Enablement</h3>
<div class="paragraph">
<p>In the area immediately below that used for <em>LDAP Host Configuration</em>, fields to enable user authentication can be made visible by means of the <strong>Enable LDAP user authentication</strong> switch.
Enablement means that users who attempt to access Couchbase Server without having been added as <em>local</em> users will be authenticated against the specified <strong>LDAP Host(s)</strong>.</p>
</div>
<div class="paragraph">
<p>Switch on, to enable.
This expands the dialog vertically, as follows:</p>
</div>
<div id="configure-ldap-dialog-enable-ldap-user-auth-field" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/configureLdapEnableLdapUserAuthField.png" alt="configureLdapEnableLdapUserAuthField" width="400">
</div>
</div>
<div class="paragraph">
<p>This provides two options whereby usernames can be mapped to LDAP <em>Distinguished Names</em> (<a href="https://ldap.com/ldap-dns-and-rdns/" target="_blank" rel="noopener">DN</a>).
The options are as follows.</p>
</div>
<div class="sect3">
<h4 id="template"><a class="anchor" href="#template"></a>Template</h4>
<div class="paragraph">
<p>The default option is <strong>Template</strong>.
An appropriate username-to-DN mapping should be entered into the <strong>Template</strong> editable text field: this avoids the need to request the LDAP server itself to provide the mapping.
The required format is indicated by the placeholder text, within the field.</p>
</div>
<div class="paragraph">
<p>The <code>%u</code> will be replaced by the username that has been presented to Couchbase Server by the user who is attempting to gain access.
For example, if the template is <code>cn=%u,dc=example,dc=com</code> and the user logs in as <code>exampleUser</code>, the user will be mapped to the DN <code>cn=exampleUser,dc=example,dc=com</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ldap-query-user"><a class="anchor" href="#ldap-query-user"></a>LDAP Search</h4>
<div class="paragraph">
<p>Selecting <strong>LDAP Search</strong> displays the following:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/ldapQuery.png" alt="ldapQuery" width="400">
</div>
</div>
<div class="paragraph">
<p>Couchbase Server performs the specified LDAP <a href="https://ldap.com/the-ldap-search-operation/" target="_blank" rel="noopener">search operation</a> to get the user&#8217;s DN from LDAP server.
<strong>Base</strong> is the <em>search base</em> DN.
<strong>Filter</strong> is the  <a href="https://ldap.com/ldap-filters/" target="_blank" rel="noopener">search filter</a>.
For example, if <strong>Base</strong> is specified as <code>ou=users,dc=example,dc=com</code>, <strong>Filter</strong> as <code>(uid=%u)</code>, and the user has provided <code>exampleUser</code> to Couchbase Server as their username, Couchbase Server performs the following search, in order to obtain the user&#8217;s DN: <code>ou=users,dc=example,dc=com??one?(uid=exampleUser)</code>.</p>
</div>
<div class="paragraph">
<p><strong>Scope</strong> (as defined in <a href="https://ldapwiki.com/wiki/LDAP%20Search%20Scopes" target="_blank" rel="noopener">LDAP Search Scopes</a>) can be determined by a pulldown menu:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/scopePulldown.png" alt="scopePulldown" width="230">
</div>
</div>
<div class="paragraph">
<p>The possible values are <strong>base object</strong>, <strong>one-level</strong>, and <strong>subtree</strong>.</p>
</div>
<div class="paragraph">
<p>For further information on <strong>Base</strong>, <strong>Filter</strong>, and <strong>Scope</strong>, see <a href="https://ldap.com/the-ldap-search-operation/" target="_blank" rel="noopener">The LDAP Search Operation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="testing-user-authentication"><a class="anchor" href="#testing-user-authentication"></a>Testing User Authentication</h4>
<div class="paragraph">
<p><strong>Test User Authentication</strong>, when opened, provides options for testing the authentication of specific users:</p>
</div>
<div id="test-user-auth-field" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/testUserAuth.png" alt="testUserAuth" width="400">
</div>
</div>
<div class="paragraph">
<p>Enter the username and password for the user, and left-click on <strong>Test User Authentication</strong>.
Couchbase Server maps the specified username to an LDAP DN, and performs authentication on the LDAP server.
Notifications confirming success or failure duly appear on the dialog.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="group-authorization-enablement"><a class="anchor" href="#group-authorization-enablement"></a>Group Authorization Enablement</h3>
<div class="paragraph">
<p>In the area immediately below that used for <em>User Authentication Enablement</em>, fields for enabling <em>LDAP Group Support</em> can be made visible by means of the <strong>Enable LDAP group authorization &amp; sync</strong> switch.
Enablement means that when a user has been authenticated by the <strong>LDAP Hosts(s)</strong>, Couchbase Server retrieves the <em>LDAP group membership</em> information for that user, in order to authorize them.
In each case where an LDAP group has been <em>mapped</em> to a Couchbase-Server user-group, the user is granted the privileges corresponding to the roles assigned that user-group.</p>
</div>
<div class="paragraph">
<p>Switch on, to enable.
This expands the dialog vertically, as follows:</p>
</div>
<div id="configure-dialog-test-groups-query" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/configureLDAPgroupsPanel.png" alt="configureLDAPgroupsPanel" width="400">
</div>
</div>
<div class="paragraph">
<p>The LDAP groups of which a user is a member can be searched for by means of either the <strong>User&#8217;s attributes</strong> or an <strong>LDAP Search</strong>, each of which is provided as a radio-button option.
Selection of either reveals a corresponding set of fields, in which information can be added.
These are as follows.</p>
</div>
<div class="sect3">
<h4 id="users-attributes"><a class="anchor" href="#users-attributes"></a>User&#8217;s Attributes</h4>
<div class="paragraph">
<p>The <strong>User&#8217;s attributes</strong> radio-button is selected by default.
This instructs Couchbase Server to assume that each LDAP user-record contains an attribute featuring the list of groups of which the user is a member.
Couchbase Server therefore performs the following LDAP search: <code>&lt;userDN&gt;?&lt;attribute&gt;?one</code>.</p>
</div>
<div class="paragraph">
<p>The value of the specified <code>attribute</code> is treated as a list of groups.
For example, if <code>attribute</code> is set in the <strong>User Attribute</strong> field to <code>memberOf</code>,
Couchbase Server performs the following search for the specified user&#8217;s groups:
<code>uid=exampleUser,dc=example,dc=com?memberOf?one</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="traverse-nested-groups-for-user-attributes"><a class="anchor" href="#traverse-nested-groups-for-user-attributes"></a>Traverse Nested Groups, for User Attribute Search</h4>
<div class="paragraph">
<p>The <strong>Traverse nested groups</strong> checkbox, when checked, allows nested groups to be traversed by the search.
Couchbase Server uses the same search to find groups of groups recursively (with each group&#8217;s DN being substituted for <code>%D</code>).
If nested search is selected, <code>%u</code> cannot be used.</p>
</div>
<div class="paragraph">
<p>Note that use of nested groups may significantly increase load on the LDAP server; and should therefore only be used if essential.</p>
</div>
</div>
<div class="sect3">
<h4 id="test-groups-query-for-user-attributes"><a class="anchor" href="#test-groups-query-for-user-attributes"></a>Test Groups Query, for User Attribute Search</h4>
<div class="paragraph">
<p><strong>Test Groups Query</strong> permits a query to be tested for a specific user.
Left-click to open:</p>
</div>
<div id="configure-ldap-test-groups-query" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/testGroupsQuery.png" alt="testGroupsQuery" width="340">
</div>
</div>
<div class="paragraph">
<p>To perform the search, add a username, and left-click on the <strong>Test Groups Query</strong> button.
Notifications confirming success or failure appear on the dialog.</p>
</div>
</div>
<div class="sect3">
<h4 id="ldap-query-group"><a class="anchor" href="#ldap-query-group"></a>LDAP Search</h4>
<div class="paragraph">
<p>When the <strong>LDAP Search</strong> radio-button is selected, the <strong>Query for Groups Using</strong> panel appears as follows:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/ldapConfigurationLDAPquery.png" alt="ldapConfigurationLDAPquery" width="400">
</div>
</div>
<div class="paragraph">
<p>Selection of <strong>LDAP Search</strong> instructs Couchbase Server to perform an LDAP <a href="https://ldap.com/the-ldap-search-operation/" target="_blank" rel="noopener">search operation</a>, in order to retrieve a list of the user&#8217;s groups.
<strong>Base</strong> is the <em>search base</em> DN.
<strong>Filter</strong> is the  <a href="https://ldap.com/ldap-filters/" target="_blank" rel="noopener">search filter</a>.
<strong>Scope</strong>, accessed from a pulldown menu, can be <strong>base</strong>, <strong>one</strong> (the default), or <strong>sub</strong>.</p>
</div>
<div class="paragraph">
<p>When the search is conducted, <code>%u</code> is replaced with the specified username; and <code>%D</code> is replaced with the user&#8217;s DN.
For example, <strong>Base</strong> might be specified as <code>ou=groups,dc=example,dc=com</code>, <strong>Filter</strong> as <code>(member=%D)</code>, and <strong>Scope</strong> as <code>one-level</code>:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/ldapQueryDetail.png" alt="ldapQueryDetail" width="320">
</div>
</div>
<div class="paragraph">
<p>For further information on <strong>Base</strong>, <strong>Filter</strong>, and <strong>Scope</strong>, see <a href="https://ldap.com/the-ldap-search-operation/" target="_blank" rel="noopener">The LDAP Search Operation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="traverse-nested-groups-for-ldap-query"><a class="anchor" href="#traverse-nested-groups-for-ldap-query"></a>Traverse Nested Groups, LDAP Search</h4>
<div class="paragraph">
<p>See the description provided above, in
 <a href="#traverse-nested-groups-for-user-attributes">Traverse Nested Groups, for User Attribute Search</a></p>
</div>
</div>
<div class="sect3">
<h4 id="test-groups-query-for-ldap-query"><a class="anchor" href="#test-groups-query-for-ldap-query"></a>Test Groups Query, for LDAP Search</h4>
<div class="paragraph">
<p>See the description provided above, in <a href="#test-groups-query-for-user-attributes">Test Groups Query, for User Attribute Search</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced-settings"><a class="anchor" href="#advanced-settings"></a>Advanced Settings</h3>
<div class="paragraph">
<p>It is strongly recommended that the <strong>Advanced Settings</strong> <em>not</em> be changed; except in unusual circumstances, and in accordance with expert advice.
Inappropriate settings may seriously impair system responsiveness.</p>
</div>
<div class="paragraph">
<p>Left-click to open:</p>
</div>
<div id="add-ldap-dialog-advanced-settings" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addLdapDialogAdvancedSettings.png" alt="addLdapDialogAdvancedSettings" width="440">
</div>
</div>
<div class="paragraph">
<p>The advanced settings are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Request timeout ms</strong>.
The number of milliseconds to elapse before a query times out.
The default is 5000.</p>
</li>
<li>
<p><strong>Max Parallel Connections</strong>.
The maximum number of parallel connections to the LDAP server that can be maintained.
The default is 100.</p>
</li>
<li>
<p><strong>Max Cache Records</strong>.
The maximum number of requests that can be cached.
The default is 10000.</p>
</li>
<li>
<p><strong>Cache Time-to-Live ms</strong>.
The lifetime of values in cache, in milliseconds.
The default is 300000.</p>
</li>
<li>
<p><strong>Group Max Nesting Depth</strong>.
The maximum number of recursive group-queries that the server is allowed to perform.
This option is only valid when nested groups are enabled.
The value must be an integer between 1 and 100: the default is 10.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When all required data has been entered, left-click on the <strong>Save LDAP Configuration</strong> button, at the bottom right:</p>
</div>
<div id="configure-ldap-dialog-save-button" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/configureLDAPdialogSaveButton.png" alt="configureLDAPdialogSaveButton" width="260">
</div>
</div>
<div class="paragraph">
<p>Alternatively, left-click on <strong>Cancel</strong> to abandon the configuration procedure.</p>
</div>
</div>
<div class="sect2">
<h3 id="clearing-the-cache"><a class="anchor" href="#clearing-the-cache"></a>Clearing the Cache</h3>
<div class="paragraph">
<p>The <strong>Clear Cache</strong> button is located at the lower left of the <strong>LDAP Configuration</strong> dialog:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/clearLDAPcacheButton.png" alt="clearLDAPcacheButton" width="140">
</div>
</div>
<div class="paragraph">
<p>Couchbase Server <em>caches</em> authentication responses and group-search results, thereby minimizing the number of requests to be made on the LDAP server.
Each cached value is expired after a configured time-period (controlled by the <strong>Cache Time-to-Live ms</strong> value, provided in the <a href="#advanced-settings">Advanced Settings</a> panel).
Additionally, the <strong>Clear Cache</strong> button is provided, so that all currently cached values can be explicitly removed: each subsequent authentication or group request is, on its first instance following the removal, passed to the LDAP server; and the latest values established on the LDAP server are thereby retrieved.</p>
</div>
</div>
<div class="sect2">
<h3 id="map-ldap-groups-to-couchbase-server-roles"><a class="anchor" href="#map-ldap-groups-to-couchbase-server-roles"></a>Map LDAP Groups to Couchbase-Server Roles</h3>
<div class="paragraph">
<p>To map an LDAP group to Couchbase-Server roles, create a Couchbase-Server user-group; associate the user-group with the LDAP group; and then assign roles to the user-group.</p>
</div>
<div class="paragraph">
<p>(Note that each Couchbase-Server user-group can be associated with at most <em>one</em> LDAP group &#8212; although if that LDAP group itself incorporates multiple additional LDAP groups by means of <em>LDAP-group nesting</em>, an <em>indirect</em> association with those LDAP groups occurs.)</p>
</div>
<div class="paragraph">
<p>Left-click on the <strong>ADD GROUP</strong> tab, at the upper right of the <strong>Users &amp; Groups</strong> panel, on the <strong>Security</strong> screen:</p>
</div>
<div id="access-groups-tab" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addGroupTab3.png" alt="addGroupTab3" width="180">
</div>
</div>
<div class="paragraph">
<p>This brings up the <strong>Add New Group</strong> dialog:</p>
</div>
<div id="add-new-group-dialog" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addNewGroupDialog.png" alt="addNewGroupDialog" width="420">
</div>
</div>
<div class="paragraph">
<p>The fields are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group Name</strong>.
The name of the new Couchbase-Server group to be created.</p>
</li>
<li>
<p><strong>Description</strong>.
An optional description of the new Couchbase-Server group.</p>
</li>
<li>
<p><strong>Map to LDAP Group</strong>.
Optionally, the name of the existing LDAP group to which the new Couchbase-Server group is to be mapped.
After a user has authenticated by means of LDAP, provided that LDAP group authorization has been enabled (by means of the <strong>Enable LDAP group authorization &amp; sync</strong> control, described <a href="#enable-ldap-group-authorization">above</a>), a list of the LDAP groups to which the user is assigned on that server is returned to Couchbase Server: if this list contains the LDAP group specified here, the user inherits the roles associated with the Couchbase-Server group here defined.</p>
</li>
<li>
<p><strong>Roles</strong>. The roles to be associated with the new Couchbase-Server group.
For information, see <a href="../../learn/security/authorization-overview.html" class="xref page">Authorization</a>.</p>
</li>
</ul>
</div>
<div id="add-new-group-dialog-complete" class="paragraph">
<p>With appropriate data added, the dialog might appear as follows:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addNewGroupDialogComplete.png" alt="addNewGroupDialogComplete" width="420">
</div>
</div>
<div class="paragraph">
<p>This creates a group named <code>Admins</code>, and assigns the <code>Full Admin</code> role to it, specifying as its LDAP-group mapping <code>uid=cbadmins,ou=groups,dc=example,dc=com</code>.</p>
</div>
<div id="add-new-group-save-button" class="paragraph">
<p>To save the group, left-click on the <strong>Save</strong> button, at the lower right.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addNewGroupSaveButton.png" alt="addNewGroupSaveButton" width="140">
</div>
</div>
<div class="paragraph">
<p>Alternatively, left-click on <strong>Cancel</strong> to abandon group configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="editing-a-group-mapping"><a class="anchor" href="#editing-a-group-mapping"></a>Editing a Group Mapping</h3>
<div class="paragraph">
<p>Once a group-mapping has been defined, it can be edited.</p>
</div>
<div class="paragraph">
<p>Access the <strong>Users &amp; Groups</strong> panel of the <strong>Security</strong> screen.
By default, this presents a <em>users</em> view, listing the currently defined users for the cluster.
To display the <em>groups</em> view, left-click on the <strong>Groups</strong> tab, towards the upper right:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/usersAndGroupsSelectGroups.png" alt="usersAndGroupsSelectGroups" width="120">
</div>
</div>
<div class="paragraph">
<p>This brings up the <em>groups</em> view, which shows currently defined user-groups for the cluster.</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/usersAndGroupsGroupsView.png" alt="usersAndGroupsGroupsView" width="800">
</div>
</div>
<div class="paragraph">
<p>This confirms the existence of the user-group <code>Admins</code>.</p>
</div>
<div class="paragraph">
<p>Now, left-click on the row displayed for this group.
The row expands vertically, and exposes additional controls:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/expandedGroupRow.png" alt="expandedGroupRow" width="800">
</div>
</div>
<div class="paragraph">
<p>Left-click on the <strong>Edit</strong> button, at the lower right:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/editGroupRowButton.png" alt="editGroupRowButton" width="180">
</div>
</div>
<div class="paragraph">
<p>This brings up the <strong>Edit Group Admins</strong> dialog:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/editGroupAdmins.png" alt="editGroupAdmins" width="420">
</div>
</div>
<div class="paragraph">
<p>Within this dialog, the description, mapping, or roles for the group can be edited.
For details of selecting roles within the <strong>Roles</strong> panel, see <a href="manage-users-and-roles.html" class="xref page">Manage Users, Groups, and Roles</a>.</p>
</div>
<div class="paragraph">
<p>Note that if the <strong>Delete Group</strong> button is left-clicked on, the group is deleted.
This means that all mappings between LDAP groups and the roles that were assigned to this group are also deleted.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-an-externally-authenticated-user"><a class="anchor" href="#adding-an-externally-authenticated-user"></a>Adding an Externally Authenticated User</h3>
<div class="paragraph">
<p>Couchbase-Server users can be specified as <em>externally authenticated</em>, when they are added to the system.
This allows roles to be assigned to them on the cluster; either directly, or by means of group-membership, or both.
Additionally, if one or more LDAP group-mappings have been defined for LDAP groups of which the externally authenticated user is a member, the user is recognized as a member of the Couchbase-Server user-groups to which the mappings have been made, and is thereby assigned still more roles.</p>
</div>
<div class="paragraph">
<p>Step-by-step instructions on adding externally authenticated users are provided in <a href="manage-users-and-roles.html#adding-an-externally-authenticated-user" class="xref page">Adding an Externally Authenticated User</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-ldap-with-the-cli"><a class="anchor" href="#configure-ldap-with-the-cli"></a>Configure LDAP with the CLI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure an LDAP server to be used as a point of authentication for Couchbase Server, use the <a href="#cli:cbcli/couchbase-cli-setting-ldap.adoc" class="xref unresolved">setting-ldap</a> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli setting-ldap \
--cluster http://10.143.192.101 \
--username Administrator \
--password password \
--hosts 172.23.124.25 --port 389 \
--encryption startTLS \
--ldap-cacert '/path/to/cert' \
--bind-dn 'cn=admin,dc=example,dc=com' \
--bind-password 'password' \
--authentication-enabled 1 \
--user-dn-template 'uid=%u,ou=users,dc=example,dc=com' \
--authorization-enabled 1 \
--group-query 'ou=groups,dc=example,dc=com??one?(member=%D)'</pre>
</div>
</div>
<div class="paragraph">
<p>This call references the LDAP server at <code>172.23.125.25</code>, on port <code>389</code>, and specifies <code>--authorization-enabled</code> and <code>--authentication-enabled</code> for the user-credentials that will be passed from Couchbase Server.
The argument specified for <code>--group-query</code> is the query that retrieves the LDAP groups of which the user is a member.
A <code>--user-dn-template</code> is specified as a distinguished name template.</p>
</div>
<div class="paragraph">
<p>If successful, the call produces the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: LDAP settings modified</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see the command reference for <a href="#cli:cbcli/couchbase-cli-setting-ldap.adoc" class="xref unresolved">setting-ldap</a>.</p>
</div>
<div class="sect2">
<h3 id="map-groups-with-the-cli"><a class="anchor" href="#map-groups-with-the-cli"></a>Map Groups with the CLI</h3>
<div class="paragraph">
<p>The <a href="#cli:cbcli/couchbase-cli-user-manage.adoc" class="xref unresolved">user-manage</a> command allows users and groups to be created and deleted, and roles to be assigned.</p>
</div>
<div class="paragraph">
<p>For example, a Couchbase-Server user-group can be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage -c 10.143.192.101 \
--username Administrator \
--password password \
--set-group \
--group-name admins \
--roles admin \
--group-description "Couchbase Server Administrators" \
--ldap-ref 'uid=cbadmins,ou=groups,dc=example,dc=com'</pre>
</div>
</div>
<div class="paragraph">
<p>This establishes a Couchbase-Server group named <code>admins</code>, each of whose members is granted the <code>admin</code> (the <code>Full Administrator</code>) role.
It references the LDAP group <code>uid=cbadmins,ou=groups,dc=example,dc=com</code>: from this point, LDAP-authenticated users who are in the LDAP group <code>uid=cbadmins,ou=groups,dc=example,dc=com</code> are placed in the Couchbase-Server <code>admins</code> group, and thereby are granted the <code>admin</code> role.</p>
</div>
<div class="paragraph">
<p>For examples of using the <code>user-manage</code> command to create LDAP-authenticated users, and optionally assign them to groups, see <a href="manage-users-and-roles.html#manage-external-users" class="xref page">Manage External Users</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-ldap-with-the-rest-api"><a class="anchor" href="#configure-ldap-with-the-rest-api"></a>Configure LDAP with the REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure an LDAP server to be used as a source of authentication for Couchbase Server, use the <code>/settings/ldap</code> endpoint, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X POST -u Administrator:password \
http://10.143.192.101:8091/settings/ldap \
-d hosts=172.23.124.25 \
-d port=389 \
-d encryption=StartTLSExtension \
-d serverCertValidation=true \
--data-urlencode cacert@/path/to/cert \
-d bindDN='cn=admin,dc=example,dc=com' \
-d bindPass=password \
-d authenticationEnabled=true \
--data-urlencode userDNMapping='{"template":"uid=%u,ou=users,dc=example,dc=com"}' \
-d authorizationEnabled=true \
--data-urlencode groupsQuery='ou=groups,dc=example,dc=com??one?(member=%D)'</pre>
</div>
</div>
<div class="paragraph">
<p>This call references the LDAP server at <code>172.23.125.25</code>, on port <code>389</code>, enabling authorization and authentication for user-credentials to be passed from Couchbase Server.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="../../rest-api/rest-configure-ldap.html" class="xref page">Configure LDAP</a>.</p>
</div>
<div class="sect2">
<h3 id="map-groups-with-the-rest-api"><a class="anchor" href="#map-groups-with-the-rest-api"></a>Map Groups with the REST API</h3>
<div class="paragraph">
<p>Use the <code>PUT /settings/rbac/groups/&lt;group-name&gt;</code> method and URI, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X PUT -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/groups/admins \
-d roles=admin \
-d description=Couchbase+Server+Administrators \
--data-urlencode ldap_group_ref='uid=cbadmins,ou=groups,dc=example,dc=com'</pre>
</div>
</div>
<div class="paragraph">
<p>This establishes a Couchbase Server group named <code>admins</code>, each of whose members is granted the <code>admin</code> (the <code>Full Administrator</code>) role.
It maps the <code>admins</code> group to the LDAP group <code>uid=cbadmins,ou=groups,dc=example,dc=com</code>: from this point, LDAP-authenticated external users who are in the LDAP <code>uid=cbadmins,ou=groups,dc=example,dc=com</code> group are placed in the Couchbase Server <code>admins</code> group, and thereby are granted the <code>admin</code> role.</p>
</div>
<div class="paragraph">
<p>For more information on using the REST API to manage roles, see <a href="../../rest-api/rbac.html" class="xref page">Role Based Admin Control (RBAC)</a>.</p>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../../_/js/site.js"></script>
<script defer src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
</body>
</html>
