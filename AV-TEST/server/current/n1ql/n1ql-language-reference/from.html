<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>FROM Clause | Couchbase Docs</title>
<link rel="stylesheet" href="../../../../_/css/site.css">
<script src="../../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="The FROM clause specifies the documents to be used as the input for a query.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.2">
<meta name="page-url" content="/server/current/n1ql/n1ql-language-reference/from.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/pages/n1ql-language-reference/from.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb"><a href="../query.html">Query</a></li>
<li class="crumb"><a href="index.html">SQL++ Language Reference</a></li>
<li class="crumb">Statements</li>
<li class="crumb"><a href="selectintro.html">SELECT</a></li>
<li class="crumb"><a href="from.html">FROM Clause</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">FROM Clause</h1>
<div class="labels">
<ul><li class="reference"><span><i class="fas fa-book"></i></i> reference</span></li>
</ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<style type="text/css">
  /* DOC-10177 */
  .hdlist table tr td.hdlist1,
  .hdlist table tr td.hdlist2 {
    padding: 1.5rem 0 0;
  }

  /* Compact horizontal definition lists */
  .hdlist.compact,
  .hdlist.compact {
    padding-top: 1rem;
  }
  .hdlist.compact table tr td.hdlist1,
  .hdlist.compact table tr td.hdlist2 {
    padding: 0.5rem 0 0;
  }

  /* Descriptions in horizontal description lists should have left padding */
  .hdlist table tr td.hdlist2,
  .hdlist.compact table tr td.hdlist2 {
    padding-left: 1rem;
  }

  /* Paragraphs in horizontal description lists should not have left margin */
  .hdlist table .hdlist1 + .hdlist2 p {
    margin-left: 0; !important
  }

  /* Horizontal definitions should match style of vertical definitions */
  td.hdlist1 {
    font-weight: 600;
  }
</style>
<div class="quoteblock abstract">
<blockquote>
The <code>FROM</code> clause specifies the documents to be used as the input for a query.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="purpose"><a class="anchor" href="#purpose"></a>Purpose</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>FROM</code> clause is used within a <a href="selectclause.html" class="xref page">SELECT</a> query or <a href="subqueries.html" class="xref page">subquery</a>.
It specifies the documents to be used as the input for a query.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For you to select data from keyspace or expression, you must have the <code class="param">query_select</code> privilege on that keyspace.
For more details about user roles, see
<a href="../../learn/security/authorization-overview.html" class="xref page">Authorization</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="syntax"><a class="anchor" href="#syntax"></a>Syntax</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L73">from-clause ::= 'FROM' from-terms</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/from-clause.png" alt="Syntax diagram">
</div>
</div>
<div class="sect2">
<h3 id="section_nkd_3nx_1db"><a class="anchor" href="#section_nkd_3nx_1db"></a>FROM Terms</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L77-L78">from-terms ::= ( from-keyspace | from-subquery | from-generic )
               ( join-clause | nest-clause | unnest-clause )* comma-separated-join*</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/from-terms.png" alt="Syntax diagram">
</div>
</div>
<div class="paragraph">
<p>The first FROM term may be any of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="#sec_from-keyspace">keyspace reference</a></p>
</li>
<li>
<p>A <a href="#select-expr">subquery</a> (such as derived tables)</p>
</li>
<li>
<p>A <a href="#generic-expr">generic expression</a> (nested paths, <code>CURL()</code>, or other expressions)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This may be followed by further FROM terms, each of which may be one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <a href="join.html" class="xref page">JOIN</a> clause and conditions</p>
</li>
<li>
<p>A <a href="nest.html" class="xref page">NEST</a> clause and conditions</p>
</li>
<li>
<p>An <a href="unnest.html" class="xref page">UNNEST</a> clause and conditions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In Couchbase Server 7.1 and later, you may additionally include one or more <a href="comma.html" class="xref page">comma-separated joins</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>JOIN</code> clauses, <code>NEST</code> clauses, <code>UNNEST</code> clauses, and comma-separated joins each have a <em>left-hand side</em> and a <em>right-hand side</em>.
The left-hand side is defined by the preceding FROM term; the right-hand side is defined by the FROM term itself.</p>
</div>
<div class="paragraph">
<p>When you chain multiple FROM terms together, the right-hand side of one FROM term acts as the left-hand side of the following FROM term.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="limitations"><a class="anchor" href="#limitations"></a>Limitations</h3>
<div class="ulist">
<ul>
<li>
<p>When the FROM term is an expression, <code>USE KEYS</code> or <code>USE INDEX</code> clauses are not allowed.</p>
</li>
<li>
<p>When using a lookup <code>JOIN</code> clause, an index <code>JOIN</code> clause, a <code>NEST</code> clause, or an <code>UNNEST</code> clause, the left-hand side of the join may be a keyspace identifier, an expression, or a subquery; but the right-hand side may only be a keyspace identifier.</p>
</li>
<li>
<p>When using an ANSI <code>JOIN</code> clause, the right-hand side of the join may also be a keyspace identifier, an expression, or a subquery, similar to the left-hand side.</p>
</li>
<li>
<p>You can chain comma-separated joins with ANSI <code>JOIN</code> clauses, ANSI <code>NEST</code> clauses, and <code>UNNEST</code> clauses.
However, you cannot chain comma-separated joins with lookup <code>JOIN</code> and <code>NEST</code> clauses, or index <code>JOIN</code> and <code>NEST</code> clauses.</p>
</li>
<li>
<p>The right-hand side of a comma-separated join can only be a keyspace identifier, a subquery, or a generic expression.
This means that comma-separated joins must come <em>after</em> any <code>JOIN</code>, <code>NEST</code>, or <code>UNNEST</code> clauses.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec_from-keyspace"><a class="anchor" href="#sec_from-keyspace"></a>FROM Keyspace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The FROM keyspace specifies a keyspace to query from: either a specific keyspace or a constant expression.</p>
</div>
<div class="sect2">
<h3 id="syntax-2"><a class="anchor" href="#syntax-2"></a>Syntax</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L82">from-keyspace ::= keyspace-ref ( 'AS'? alias )? use-clause?</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/from-keyspace.png" alt="Syntax diagram">
</div>
</div>
<div class="hdlist compact">
<table>
<tr>
<td class="hdlist1">
keyspace-ref
</td>
<td class="hdlist2">
<p><a href="#from-keyspace-ref">Keyspace Reference</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
alias
</td>
<td class="hdlist2">
<p><a href="#from-keyspace-alias">AS Alias</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
use-clause
</td>
<td class="hdlist2">
<p><a href="#from-keyspace-hints">USE Clause</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="from-keyspace-ref"><a class="anchor" href="#from-keyspace-ref"></a>Keyspace Reference</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L86">keyspace-ref ::= keyspace-path | keyspace-partial</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/keyspace-ref.png" alt="Syntax diagram">
</div>
</div>
<div class="hdlist compact">
<table>
<tr>
<td class="hdlist1">
keyspace-path
</td>
<td class="hdlist2">
<p><a href="#keyspace-path">Keyspace Path</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
keyspace-partial
</td>
<td class="hdlist2">
<p><a href="#keyspace-partial">Keyspace Partial</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Keyspace reference of the data source.
The identifiers that make up the keyspace reference are not available as <a href="subqueries.html#section_onz_3tj_mz" class="xref page">variables in scope of a subquery</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If there is a hyphen (-) inside any part of the keyspace reference, you must wrap that part of the keyspace reference in backticks (`&#160;`).
Refer to the examples below.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="keyspace-path"><a class="anchor" href="#keyspace-path"></a>Keyspace Path</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L90">keyspace-path ::= ( namespace ':' )? bucket ( '.' scope '.' collection )?</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/keyspace-path.png" alt="Syntax diagram">
</div>
</div>
<div class="paragraph">
<p>If the keyspace is a named collection, or the default collection in the default scope within a bucket, the keyspace reference may be a keyspace path.
In this case, the <a href="../n1ql-intro/queriesandresults.html#query-context" class="xref page">query context</a> should not be set.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">namespace</dt>
<dd>
<p>(Optional) An <a href="identifiers.html" class="xref page">identifier</a> that refers to the <a href="../n1ql-intro/sysinfo.html#logical-hierarchy" class="xref page">namespace</a> of the keyspace.
Currently, only the <code>default</code> namespace is available.
If the namespace name is omitted, the default namespace in the current session is used.</p>
</dd>
<dt class="hdlist1">bucket</dt>
<dd>
<p>(Required) An <a href="identifiers.html" class="xref page">identifier</a> that refers to the <a href="../n1ql-intro/sysinfo.html#logical-hierarchy" class="xref page">bucket name</a> of the keyspace.</p>
</dd>
<dt class="hdlist1">scope</dt>
<dd>
<p>(Optional) An <a href="identifiers.html" class="xref page">identifier</a> that refers to the <a href="../n1ql-intro/sysinfo.html#logical-hierarchy" class="xref page">scope name</a> of the keyspace.
If omitted, the bucket&#8217;s default scope is used.</p>
</dd>
<dt class="hdlist1">collection</dt>
<dd>
<p>(Optional) An <a href="identifiers.html" class="xref page">identifier</a> that refers to the <a href="../n1ql-intro/sysinfo.html#logical-hierarchy" class="xref page">collection name</a> of the keyspace.
If omitted, the default collection in the bucket&#8217;s default scope is used.</p>
</dd>
</dl>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>For example, <code>default:`travel-sample`</code> indicates the default collection in the default scope in the <code>travel-sample</code> bucket in the <code>default</code> namespace.</p>
</div>
<div class="paragraph">
<p>Similarly, <code>default:`travel-sample`.inventory.airline</code> indicates the <code>airline</code> collection in the <code>inventory</code> scope in the <code>travel-sample</code> bucket in the <code>default</code> namespace.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="keyspace-partial"><a class="anchor" href="#keyspace-partial"></a>Keyspace Partial</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L94">keyspace-partial ::= collection</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/keyspace-partial.png" alt="Syntax diagram">
</div>
</div>
<div class="paragraph">
<p>Alternatively, if the keyspace is a named collection, the keyspace reference may be just the collection name with no path.
In this case, you must set the <a href="../n1ql-intro/queriesandresults.html#query-context" class="xref page">query context</a> to indicate the required namespace, bucket, and scope.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">collection</dt>
<dd>
<p>(Required) An <a href="identifiers.html" class="xref page">identifier</a> that refers to the <a href="../n1ql-intro/sysinfo.html#logical-hierarchy" class="xref page">collection name</a> of the keyspace.</p>
</dd>
</dl>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>For example, <code>airline</code> indicates the <code>airline</code> collection, assuming the query context is set.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="from-keyspace-alias"><a class="anchor" href="#from-keyspace-alias"></a>AS Alias</h4>
<div class="paragraph">
<p>Assigns another name to the FROM keyspace.
For details, see <a href="#section_ax5_2nx_1db">AS Clause</a>.</p>
</div>
<div class="paragraph">
<p>Assigning an alias is optional for the FROM keyspace.
If you assign an alias to the FROM keyspace, the <code>AS</code> keyword may be omitted.</p>
</div>
</div>
<div class="sect3">
<h4 id="from-keyspace-hints"><a class="anchor" href="#from-keyspace-hints"></a>USE Clause</h4>
<div class="paragraph">
<p>Enables you to specify that the query should use particular keys, or a particular index.
For details, see <a href="hints.html" class="xref page">USE clause</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples"><a class="anchor" href="#examples"></a>Examples</h3>
<div class="paragraph">
<p>Unresolved include directive in modules/n1ql/pages/n1ql-language-reference/from.adoc - include::ROOT:partial$query-context.adoc[]</p>
</div>
<div class="paragraph">
<p>The simplest type of FROM keyspace clause specifies a single keyspace.</p>
</div>
<div id="ex-single-keyspace" class="exampleblock">
<div class="title">Example 1. Use a single keyspace</div>
<div class="content">
<div class="paragraph">
<p>Select four unique landmarks from the <code>landmark</code> keyspace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT DISTINCT name
FROM landmark
LIMIT 4;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Results</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">[
  {
    "name": "Royal Engineers Museum"
  },
  {
    "name": "Hollywood Bowl"
  },
  {
    "name": "Thai Won Mien"
  },
  {
    "name": "Spice Court"
  }
]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="select-expr"><a class="anchor" href="#select-expr"></a>FROM Subquery</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Specifies a SQL++ <code>SELECT</code> expression of input objects.</p>
</div>
<div class="sect2">
<h3 id="syntax-3"><a class="anchor" href="#syntax-3"></a>Syntax</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L114">from-subquery ::= subquery-expr 'AS'? alias</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/from-subquery.png" alt="Syntax diagram">
</div>
</div>
<div class="hdlist compact">
<table>
<tr>
<td class="hdlist1">
subquery-expr
</td>
<td class="hdlist2">
<p><a href="#select-expr-clause">Subquery Expression</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
<tr>
<td class="hdlist1">
alias
</td>
<td class="hdlist2">
<p><a href="#select-expr-alias">AS Alias</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="select-expr-clause"><a class="anchor" href="#select-expr-clause"></a>Subquery Expression</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L118">subquery-expr ::= '(' select ')'</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/subquery-expr.png" alt="Syntax diagram">
</div>
</div>
<div class="paragraph">
<p>Use parentheses to specify a subquery.</p>
</div>
<div class="paragraph">
<p>For more details and examples, see <a href="selectclause.html" class="xref page">SELECT Clause</a> and <a href="subqueries.html" class="xref page">Subqueries</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="select-expr-alias"><a class="anchor" href="#select-expr-alias"></a>AS Alias</h4>
<div class="paragraph">
<p>Assigns another name to the subquery.
For details, see <a href="#section_ax5_2nx_1db">AS Clause</a>.</p>
</div>
<div class="paragraph">
<p>Assigning an alias is required for subqueries in the FROM term.
However, when you assign an alias to the subquery, the <code>AS</code> keyword may be omitted.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-2"><a class="anchor" href="#examples-2"></a>Examples</h3>
<div class="paragraph">
<p>Unresolved include directive in modules/n1ql/pages/n1ql-language-reference/from.adoc - include::ROOT:partial$query-context.adoc[]</p>
</div>
<div id="ex-subquery-1" class="exampleblock">
<div class="title">Example 2. A <code>SELECT</code> clause inside a <code>FROM</code> clause.</div>
<div class="content">
<div class="paragraph">
<p>List all <code>Gillingham</code> landmark names from a subset of all landmark eating places.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT name, city
FROM (SELECT id, name, address, city
      FROM landmark
      WHERE activity = "eat") AS l
WHERE city = "Gillingham";</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Results</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">[
  {
    "city": "Gillingham",
    "name": "Hollywood Bowl"
  },
  {
    "city": "Gillingham",
    "name": "Thai Won Mien"
  },
  {
    "city": "Gillingham",
    "name": "Spice Court"
  },
  {
    "city": "Gillingham",
    "name": "Beijing Inn"
  },
  {
    "city": "Gillingham",
    "name": "Ossie's Fish and Chips"
  }
]</code></pre>
</div>
</div>
</div>
</div>
<div id="ex-subquery-2" class="exampleblock">
<div class="title">Example 3. Subquery Example</div>
<div class="content">
<div class="paragraph">
<p>For each country, find the number of airports at different altitudes and their corresponding cities.</p>
</div>
<div class="paragraph">
<p>In this case, the inner query finds the first level of grouping of different altitudes by country and corresponding number of cities.
Then the outer query builds on the inner query results to count the number of different altitude groups for each country and the total number of cities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT t1.country, num_alts, total_cities
FROM (SELECT country, geo.alt AS alt,
             count(city) AS num_cities
      FROM airport
      GROUP BY country, geo.alt) t1
GROUP BY t1.country
LETTING num_alts = count(t1.alt), total_cities = sum(t1.num_cities);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Results</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">[
  {
    "country": "United States",
    "num_alts": 946,
    "total_cities": 1560
  },
  {
    "country": "United Kingdom",
    "num_alts": 128,
    "total_cities": 187
  },
  {
    "country": "France",
    "num_alts": 196,
    "total_cities": 221
  }
]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This is equivalent to blending the results of the following two queries by country, but the subquery in the <code>from-term</code> above simplified it.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT country,count(city) AS num_cities
FROM airport
GROUP BY country;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT country, count(distinct geo.alt) AS num_alts
FROM airport
GROUP BY country;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generic-expr"><a class="anchor" href="#generic-expr"></a>FROM Generic Expression</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Generic <a href="index.html" class="xref page">expressions</a> in the FROM term may include SQL++ functions, operators, path expressions, language constructs on constant expressions, variables, and subqueries.
This adds huge flexibility by enabling just about any FROM clause imaginable.</p>
</div>
<div class="sect2">
<h3 id="syntax-4"><a class="anchor" href="#syntax-4"></a>Syntax</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ebnf hljs" data-lang="ebnf" data-source-url="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/n1ql/partials/grammar/dql.ebnf#L122">from-generic ::= expr ( 'AS' alias )?</code></pre>
</div>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/n1ql-language-reference/from-generic.png" alt="Syntax diagram">
</div>
</div>
<div class="hdlist compact">
<table>
<tr>
<td class="hdlist1">
expr
</td>
<td class="hdlist2">
<p>A SQL++ expression generating JSON documents or objects.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
alias
</td>
<td class="hdlist2">
<p><a href="#generic-expr-alias">AS Alias</a> <span class="icon"><i class="fa fa-caret-down"></i></span></p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="generic-expr-alias"><a class="anchor" href="#generic-expr-alias"></a>AS Alias</h4>
<div class="paragraph">
<p>Assigns another name to the generic expression.
For details, see <a href="#section_ax5_2nx_1db">AS Clause</a>.</p>
</div>
<div class="paragraph">
<p>Assigning an alias is optional for generic expressions in the FROM term.
However, when you assign an alias to the expression, the <code>AS</code> keyword is required.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-3"><a class="anchor" href="#examples-3"></a>Examples</h3>
<div class="paragraph">
<p>Unresolved include directive in modules/n1ql/pages/n1ql-language-reference/from.adoc - include::ROOT:partial$query-context.adoc[]</p>
</div>
<div id="ex-constant-expr" class="exampleblock">
<div class="title">Example 4. Independent Constant Expression</div>
<div class="content">
<div class="paragraph">
<p>The expression may include JSON scalar values, static JSON literals, objects, or SQL++ functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT * FROM [1, 2, "name", { "type" : "airport", "id" : "SFO"}] AS ks1;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT CURL("https://maps.googleapis.com/maps/api/geocode/json",
           {"data":"address=Half+Moon+Bay" , "request":"GET"} );</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Note that functions such as <a href="curl.html" class="xref page">CURL()</a> can independently produce input data objects for the query.
Similarly, other SQL++ functions can also be used in the expressions.</p>
</div>
<div id="ex-var-expr" class="exampleblock">
<div class="title">Example 5. Variable SQL++ Expression</div>
<div class="content">
<div class="paragraph">
<p>The expression may refer to any <a href="subqueries.html#section_onz_3tj_mz" class="xref page">variables in scope</a> for the query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT count(*)
FROM airport t
LET x = t.geo
WHERE (SELECT RAW y.alt FROM x y)[0] &gt; 6000;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>FROM x</code> clause is an expression that refers to the outer query.
This is applicable to only subqueries because the outermost level query cannot use any variables in its own <code>FROM</code> clause.
This makes the subquery correlated with outer queries, as explained in the <a href="subqueries.html" class="xref page">Subqueries</a> section.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="section_ax5_2nx_1db"><a class="anchor" href="#section_ax5_2nx_1db"></a>AS Clause</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use a shorter or clearer name anywhere in the query, like SQL, SQL++ allows you to assign an alias to any FROM term in the <code>FROM</code> clause.</p>
</div>
<div class="sect2">
<h3 id="syntax-5"><a class="anchor" href="#syntax-5"></a>Syntax</h3>
<div class="paragraph">
<p>The <code>AS</code> keyword is required when assigning an alias to a generic expression.</p>
</div>
<div class="paragraph">
<p>The <code>AS</code> keyword is optional when assigning an alias to the FROM keyspace, a subquery, the JOIN clause, the NEST clause, or the UNNEST clause.</p>
</div>
</div>
<div class="sect2">
<h3 id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">alias</dt>
<dd>
<p>String to assign an alias.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the original name may lead to referencing wrong data and wrong results, you must use the alias name throughout the query instead of the original keyspace name.</p>
</div>
<div class="paragraph">
<p>In the FROM clause, the renaming appears only in the projection and not the fields themselves.</p>
</div>
<div class="paragraph">
<p>When no alias is used, the keyspace or last field name of an expression is given as the implicit alias.</p>
</div>
<div class="paragraph">
<p>When an alias conflicts with a keyspace or field name in the same scope, the identifier always refers to the alias.
This allows for consistent behavior in scenarios where an identifier only conflicts in some documents.
For more information on aliases, see <a href="identifiers.html" class="xref page">Identifiers</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="examples-4"><a class="anchor" href="#examples-4"></a>Examples</h3>
<div class="paragraph">
<p>Unresolved include directive in modules/n1ql/pages/n1ql-language-reference/from.adoc - include::ROOT:partial$query-context.adoc[]</p>
</div>
<div class="paragraph">
<p>The following <code>FROM</code> clauses are equivalent, with and without the <code>AS</code> keyword.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">FROM airport AS t</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">FROM airport t</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">FROM hotel AS h
INNER JOIN landmark AS l
ON (h.city = l.city)</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">FROM hotel h
INNER JOIN landmark l
ON (h.city = l.city)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-links"><a class="anchor" href="#related-links"></a>Related Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="hints.html" class="xref page">USE Clause</a></p>
</li>
<li>
<p><a href="join.html" class="xref page">JOIN Clause</a></p>
</li>
<li>
<p><a href="nest.html" class="xref page">NEST Clause</a></p>
</li>
<li>
<p><a href="unnest.html" class="xref page">UNNEST Clause</a></p>
</li>
<li>
<p><a href="comma.html" class="xref page">Comma-Separated Join</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../../_/js/site.js"></script>
<script defer src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
</body>
</html>
