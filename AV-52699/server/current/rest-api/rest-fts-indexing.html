<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Indexes | Couchbase Docs</title>
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.2">
<meta name="page-url" content="/server/current/rest-api/rest-fts-indexing.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/rest-api/pages/rest-fts-indexing.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb">Reference</li>
<li class="crumb"><a href="rest-intro.html">REST API Reference</a></li>
<li class="crumb"><a href="rest-fts.html">Search Service API</a></li>
<li class="crumb"><a href="rest-fts-indexing.html">Indexes</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Indexes</h1>
<div class="labels">
<ul></ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div class="sect1">
<h2 id="index-definition"><a class="anchor" href="#index-definition"></a>Index Definition</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a id="g-api-index"></a>GET /api/index</dt>
<dd>
<p>Returns all index definitions as JSON.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="listingblock">
<div class="title">Sample Response</div>
<div class="content">
<pre>{
    "indexDefs": {
        "implVersion": "4.0.0",
        "indexDefs": {
            "myFirstIndex": {
            "name": "myFirstIndex",
            "params": "",
            "planParams": {
                "hierarchyRules": null,
                "maxPartitionsPerPIndex": 0,
                "nodePlanParams": null,
                "numReplicas": 0,
                "planFrozen": false
             },
             "sourceName": "",
             "sourceParams": "",
             "sourceType": "nil",
             "sourceUUID": "",
             "type": "fulltext-index",
             "uuid": "6cc599ab7a85bf3b"
          }
       },
       "uuid": "6cc599ab7a85bf3b"
    },
    "status": "ok"
}</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><a id="g-api-index-name"></a>GET /api/index/{indexName}</dt>
<dd>
<p>Returns the definition of an index as JSON.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>:  FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index definition to be retrieved.</p>
</div>
<div class="listingblock">
<div class="title">Sample response</div>
<div class="content">
<pre>{
    "indexDef": {
        "name": "myFirstIndex",
        "params": "",
        "planParams": {
            "hierarchyRules": null,
            "maxPartitionsPerPIndex": 0,
            "nodePlanParams": null,
            "numReplicas": 0,
            "planFrozen": false
        },
        "sourceName": "",
        "sourceParams": "",
        "source
            ": "nil",
        "sourceUUID": "",
        "type": "fulltext-index",
        "uuid": "6cc599ab7a85bf3b"
      },
      "planPIndexes": [
        {
         "indexName": "myFirstIndex",
         "indexParams": "",
         "indexType": "bleve",
         "indexUUID": "6cc599ab7a85bf3b",
         "name": "myFirstIndex_6cc599ab7a85bf3b_0",
         "nodes": {
            "78fc2ffac2fd9401": {
              "canRead": true,
              "canWrite": true,
              "priority": 0
            }
         },
         "sourceName": "",
         "sourceParams": "",
         "sourcePartitions": "",
         "sourceType": "nil",
         "sourceUUID": "",
         "uuid": "64bed6e2edf354c3"
         }
       ],
       "status": "ok",
       "warnings": []
       }</pre>
</div>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a id="p-api-index-name"></a>PUT /api/index/{indexName}</dt>
<dd>
<p>Creates/updates an index definition.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!write</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the to-be-created/updated index definition, validated with the regular expression <code>^[A-Za-z][0-9A-Za-z_\-]*$</code>.</p>
</div>
</li>
<li>
<p><code class="param">indexParams</code>: optional (depends on the value of the indexType), string (JSON), form parameter</p>
<div class="ulist">
<ul>
<li>
<p>For indexType <code class="in">alias</code>, an example <code class="param">indexParams</code> JSON:</p>
<div class="listingblock">
<div class="content">
<pre>{
    "targets": {
        "yourIndexName": {
            "indexUUID": ""
        }
     }
}</pre>
</div>
</div>
</li>
<li>
<p>For indexType <code class="in">bleve</code>, an example <code class="param">indexParams</code> JSON:</p>
<div class="listingblock">
<div class="content">
<pre>{
    "mapping": {
        "default_mapping": {
            "enabled": true,
            "dynamic": true,
            "default_analyzer": ""
         },
         "type_field": "_type",
         "default_type": "_default",
         "default_analyzer": "standard",
         "default_datetime_parser": "dateTimeOptional",
         "default_field": "_all",
         "byte_array_converter": "json",
         "analysis": {}
     },
     "store": {
          "kvStoreName": "mossStore"
     }
     }</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code class="param">indexType</code>: required, string, form parameter</p>
<div class="paragraph">
<p>Supported index types include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>alias: an alias provides a naming level of indirection to one or more actual, target indexes</p>
</li>
<li>
<p>bleve: a full-text index powered by the bleve engine</p>
</li>
</ul>
</div>
</li>
<li>
<p><code class="param">planParams</code>: optional, string (JSON), form parameter</p>
</li>
<li>
<p><code class="param">prevIndexUUID</code>: optional, string, form parameter</p>
<div class="paragraph">
<p>Intended for clients that want to check that they are not overwriting the index definition updates of concurrent clients.</p>
</div>
</li>
<li>
<p><code class="param">sourceName</code>: optional, string, form parameter</p>
</li>
<li>
<p><code class="param">sourceParams</code>: optional (depends on the value of the sourceType), string (JSON), form parameter</p>
<div class="paragraph">
<p>For sourceType <code class="in">couchbase</code>, an example sourceParams JSON:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
              "authUser": "",
              "authPassword": "",
              "authSaslUser": "",
              "authSaslPassword": "",
              "clusterManagerBackoffFactor": 0,
              "clusterManagerSleepInitMS": 0,
              "clusterManagerSleepMaxMS": 20000,
              "dataManagerBackoffFactor": 0,
              "dataManagerSleepInitMS": 0,
              "dataManagerSleepMaxMS": 20000,
              "feedBufferSizeBytes": 0,
              "feedBufferAckThreshold": 0
}</pre>
</div>
</div>
</li>
<li>
<p><code class="param">sourceUUID</code>: optional, string, form parameter</p>
</li>
<li>
<p><code class="param">result on error</code>: Non-200 HTTP error code</p>
</li>
<li>
<p><code class="param">result on success</code>: HTTP 200 with body JSON of <code>{"status": "ok"}</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a id="d-api-index-name"></a>DELETE /api/index/{indexName}</dt>
<dd>
<p>Deletes an index definition.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!write</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index definition to be deleted.</p>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="index-management"><a class="anchor" href="#index-management"></a>Index Management</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a id="p-api-idx-name-ingestcontrol"></a>POST /api/index/{indexName}/ingestControl/{op}</dt>
<dd>
<p>Pause index updates and maintenance (no more ingesting document mutations).</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!manage</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index whose control values will be modified.</p>
</div>
</li>
<li>
<p><code class="param">op</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>Allowed values for op are "pause" or "resume".</p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a id="p-api-idx-name-planfreezecontrol"></a>POST /api/index/{indexName}/planFreezeControl/{op}</dt>
<dd>
<p>Freeze the assignment of index partitions to nodes.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!manage</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index whose control values will be modified.</p>
</div>
</li>
<li>
<p><code class="param">op</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>Allowed values for op are "freeze" or "unfreeze".</p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a id="p-api-idx-name-querycontrol"></a>POST /api/index/{indexName}/queryControl/{op}</dt>
<dd>
<p>Disallow queries on an index.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!manage</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index whose control values will be modified.</p>
</div>
</li>
<li>
<p><code class="param">op</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>Allowed values for op are "allow" or "disallow".</p>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="index-monitoring-and-debugging"><a class="anchor" href="#index-monitoring-and-debugging"></a>Index Monitoring And Debugging</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a id="g-api-stats"></a>GET /api/stats</dt>
<dd>
<p>Returns indexing and data related metrics, timings and counters from the node as JSON.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].stats!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="listingblock">
<div class="title">Sample response</div>
<div class="content">
<pre>{
    "feeds": {
        "myFirstIndex_6cc599ab7a85bf3b": {}
    },
    "manager": {
        "TotCreateIndex": 1,
        "TotCreateIndexOk": 1,
        "TotDeleteIndex": 0,
        "TotDeleteIndexOk": 0,
        "TotIndexControl": 0,
        "TotIndexControlOk": 0,
        "TotJanitorClosePIndex": 0,
        "TotJanitorKick": 2,
        "TotJanitorKickErr": 0,
        "TotJanitorKickOk": 2,
        "TotJanitorKickStart": 2,
        "TotJanitorNOOP": 0,
        "TotJanitorNOOPOk": 0,
        "TotJanitorRemovePIndex": 0,
        "TotJanitorSubscriptionEvent": 0,
        "TotJanitorUnknownErr": 0,
        "TotKick": 0,
        "TotPlannerKick": 2,
        "TotPlannerKickChanged": 1,
        "TotPlannerKickErr": 0,
        "TotPlannerKickOk": 2,
        "TotPlannerKickStart": 2,
        "TotPlannerNOOP": 0,
        "TotPlannerNOOPOk": 0,
        "TotPlannerSubscriptionEvent": 0,
        "TotPlannerUnknownErr": 0,
        "TotSaveNodeDef": 2,
        "TotSaveNodeDefGetErr": 0,
        "TotSaveNodeDefOk": 2,
        "TotSaveNodeDefSame": 0,
        "TotSaveNodeDefSetErr": 0
     },
     "pindexes": {
         "myFirstIndex_6cc599ab7a85bf3b_0": null
     }
}</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><a id="g-api-stats-index-name"></a>GET /api/stats/index/{indexName}</dt>
<dd>
<p>Returns metrics, timings and counters for a single index from the node as JSON.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].stats!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Admin</p>
</div>
<div class="listingblock">
<div class="title">Sample response</div>
<div class="content">
<pre>{
    "feeds": {
        "myFirstIndex_6cc599ab7a85bf3b": {}
    },
    "pindexes": {
        "myFirstIndex_6cc599ab7a85bf3b_0": null
    }
}</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><a id="g-api-stats-index-name-analyzeDoc"></a>POST /api/index/{indexName}/analyzeDoc</dt>
<dd>
<p>Sends a json document to the given index for text analysis.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Searcher, FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index against which the analysis needs to performed.</p>
</div>
<div class="paragraph">
<p>The request&#8217;s POST body contains any sample json document.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
   "name": "hello world",
   "title": "couchbase blr"}
}</pre>
</div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="response-object"><a class="anchor" href="#response-object"></a>Response Object</h3>
<div class="paragraph">
<p>A sample response for an index definition with keyword analyzer set against the title field and an ngram
(min=2, max=5) tokenfilter set against the name field would be like below for the above request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "status": "ok",
  "analyzed": [
    {
      "couchbase blr": {
        "Term": "Y291Y2hiYXNlIGJscg==",
        "Locations": [
          {
            "Field": "title",
            "ArrayPositions": [],
            "Start": 0,
            "End": 13,
            "Position": 1
          }
        ]
      }
    },
    {
      "he": {
        "Term": "aGU=",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 0,
            "End": 5,
            "Position": 1
          }
        ]
      },
      "hel": {
        "Term": "aGVs",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 0,
            "End": 5,
            "Position": 1
          }
        ]
      },
      "hell": {
        "Term": "aGVsbA==",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 0,
            "End": 5,
            "Position": 1
          }
        ]
      },
      "hello": {
        "Term": "aGVsbG8=",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 0,
            "End": 5,
            "Position": 1
          }
        ]
      },
      "wo": {
        "Term": "d28=",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 6,
            "End": 11,
            "Position": 2
          }
        ]
      },
      "wor": {
        "Term": "d29y",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 6,
            "End": 11,
            "Position": 2
          }
        ]
      },
      "worl": {
        "Term": "d29ybA==",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 6,
            "End": 11,
            "Position": 2
          }
        ]
      },
      "world": {
        "Term": "d29ybGQ=",
        "Locations": [
          {
            "Field": "name",
            "ArrayPositions": [],
            "Start": 6,
            "End": 11,
            "Position": 2
          }
        ]
      }
    },
    null
  ]
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="index-querying"><a class="anchor" href="#index-querying"></a>Index Querying</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a id="g-api-index-name-count"></a>GET /api/index/{indexName}/count</dt>
<dd>
<p>Returns the count of indexed documents.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Searcher, FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index whose count is to be retrieved.</p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><a id="p-api-index-name-query"></a>POST /api/index/{indexName}/query</dt>
<dd>
<p>Queries an index.</p>
<div class="paragraph">
<p><strong>Permission Required</strong>: cluster.bucket[<code class="var">bucket_name</code>].fts!read</p>
</div>
<div class="paragraph">
<p><strong>Role Required</strong>: FTS-Searcher, FTS-Admin</p>
</div>
<div class="paragraph">
<p><strong>Parameters</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code class="param">indexName</code>: required, string, URL path parameter</p>
<div class="paragraph">
<p>The name of the index to be queried.</p>
</div>
<div class="paragraph">
<p>The request&#8217;s POST body depends on the index type.
For index type bleve, here&#8217;s a simple query POST body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    "query": {
        "query": "a sample query",
        "boost": 1
    },
    "size": 10,
    "from": 0,
    "highlight": null,
    "fields": null,
    "facets": null,
    "explain": false
    }</pre>
</div>
</div>
<div class="paragraph">
<p>An example POST body using from/size for results paging, using ctl for a timeout and for "at_plus" consistency level.
On consistency, the index must have incorporated at least mutation sequence-number 123 for partition (vbucket) 0 and mutation sequence-number 234 for partition (vbucket) 1 (where vbucket 1 should have a vbucketUUID of a0b1c2):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
    "ctl": {
        "timeout": 10000,
        "consistency": {
            "level": "at_plus",
                "vectors": {
                    "customerIndex": {
                        "0": 123,
                        "1/a0b1c2": 234
                    }
                }
            }
        },
        "query": {
            "query": "alice smith",
            "boost": 1
        },
        "size": 10,
        "from": 20,
        "highlight": {
            "style": null,
            "fields": null
        },
        "fields": [
            "*"
        ],
        "facets": null,
        "explain": true
}</pre>
</div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="response-object-2"><a class="anchor" href="#response-object-2"></a>Response Object</h3>
<div class="paragraph">
<p>The response object has a status section that must be checked for every request.
Under nearly all circumstances, the query response will be HTTP 200 even though individual index shards (pindexes) may encounter a timeout or return an error.</p>
</div>
<div class="paragraph">
<p><strong>Consistency and Timeouts</strong></p>
</div>
<div class="paragraph">
<p>A query can specify a timeout value, a consistency requirement, or both.
This section explains how this affects the query behavior and how to handle the resulting query return values.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>logical first phase consistency wait - if timeout in this period, get 416 error with message saying request could not be satisfied).</p>
</li>
<li>
<p>If consistency wait times out with 416, return value to client will indicate the sequence number range processed so the client will have an idea how far the processing got and has the option of retrying more intelligently.</p>
</li>
<li>
<p>In phase 2, you have the normal pindex timeout.
This will start whenever the first phase completes.
At this point, request will return 200 HTTP response code unless there is an internal server error.</p>
</li>
<li>
<p>Client must check response status, which will return any errors or timeouts for each pindex.
If The response includes the number of errors, and the client can determine whether they need the complete results or can continue as long as enough pindexes return to give a reasonable user experience.
Note that the query return status will be 200 even if all pindexes return errors so it&#8217;s critical to check the response status and code accordingly.</p>
</li>
<li>
<p>If client sets timeout very low, e.g.
1ms, you may receive a 200 error with all timeouts instead of a consistency wait timeout.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
