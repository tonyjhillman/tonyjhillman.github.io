<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Manage Users, Groups, and Roles | Couchbase Docs</title>
<link rel="stylesheet" href="../../../../_/css/site.css">
<script src="../../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Couchbase Server allows defined &lt;em&gt;users&lt;/em&gt; to be assigned roles, which permit access to resources.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.2">
<meta name="page-url" content="/server/current/manage/manage-security/manage-users-and-roles.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/manage/pages/manage-security/manage-users-and-roles.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb">Manage</li>
<li class="crumb"><a href="security-management-overview.html">Manage Security</a></li>
<li class="crumb"><a href="manage-users-and-roles.html">Manage Users, Groups, and Roles</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Manage Users, Groups, and Roles</h1>
<div class="labels">
<ul></ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
Couchbase Server allows defined <em>users</em> to be assigned roles, which permit access to resources.
Additionally, <em>groups</em> of users can be established, and roles assigned to each group; so that each user is granted the roles of each group of which they are a member.
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-and-managing-users"><a class="anchor" href="#creating-and-managing-users"></a>Creating and Managing Users and Groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The administrator who initially performs installation and configuration of Couchbase Server is granted the role of <em>Full Administrator</em>, with complete access to the entire system, including <em>read</em> and <em>write</em> privileges.
Once basic system configuration has been completed, the Full Administrator is free to add other users to the system, and assign them roles; thereby specifying their privileges.</p>
</div>
<div class="paragraph">
<p>Note that a cluster running Couchbase Server <em>Enterprise Edition</em> can have any number of users.
A cluster running <em>Community Edition</em> can have a maximum of twenty users.</p>
</div>
<div class="paragraph">
<p>As Full Administrator, to add <em>users</em> (each of which might be either an <em>administrator</em> or an <em>application</em>) and <em>groups</em> to Couchbase Server, use <a href="#manage-users-with-the-ui">Couchbase Web Console</a>, the <a href="#manage-users-with-the-cli">CLI</a>, or the <a href="#manage-users-with-the-rest-api">REST API</a>, as described in the sections below.</p>
</div>
<div class="paragraph">
<p>For a general overview of Couchbase-Server authorization, see <a href="../../learn/security/authorization-overview.html" class="xref page">Authorization</a>.
For a list of available roles and corresponding privileges, see <a href="../../learn/security/roles.html" class="xref page">Roles</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manage-users-with-the-ui"><a class="anchor" href="#manage-users-with-the-ui"></a>Manage Users and Groups with the UI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Access the <strong class="ui">Dashboard</strong> of Couchbase Web Console, and left-click on the <strong class="ui">Security</strong> tab, on the vertical navigation-bar, at the left.
This brings up the <strong class="ui">Security</strong> view, as follows:</p>
</div>
<div id="security_view" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/securityView.png" alt="securityView" width="820">
</div>
</div>
<div id="users-and-groups-panel" class="paragraph">
<p>The <strong>Users &amp; Groups</strong> panel, which is visible by default on the <strong class="ui">Security</strong> screen, allows <em>users</em> and <em>groups</em> to be defined.
It also allows <em>roles</em> to be assigned to users and groups.
If at any time the <strong>Users &amp; Groups</strong> panel is not currently visible, access it by left-clicking on the <strong>Users &amp; Groups</strong> tab, which is located at the left-hand side of the upper, horizontal navigation-bar:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/usersAndGroupsTab.png" alt="usersAndGroupsTab" width="170">
</div>
</div>
<div id="external_auth_not_enabled" class="paragraph">
<p>Initially, the panel shows that no users have yet been defined.
(The Full Administrator who established the cluster is never included on the list; which contains only administrators subsequently defined.)</p>
</div>
<div class="paragraph">
<p>Note that the following notification may appear in the upper area of the screen:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/externalAuthNotEnabled.png" alt="externalAuthNotEnabled" width="175">
</div>
</div>
<div class="paragraph">
<p>This indicates that no ability to support <em>external authentication</em> &#8212; by means of either <code>saslauthd</code> or <code>LDAP</code> &#8212; has yet been enabled.
To enable LDAP, see the first step of the command-sequence provided in <a href="configure-saslauthd.html#getting-started-with-saslauthd-and-ldap" class="xref page">Getting Started with saslauthd and LDAP</a>.
For a general overview of external authentication, see
<a href="../../learn/security/authentication-domains.html" class="xref page">Authentication Domains</a>.</p>
</div>
<div class="sect2">
<h3 id="add-a-group"><a class="anchor" href="#add-a-group"></a>Add a Group</h3>
<div class="paragraph">
<p>A <em>group</em> can be defined, and roles assigned to it, by means of Couchbase Web Console.
Users can then be defined, and assigned to each group; each user thus being granted the group&#8217;s roles.
Groups may provide the most efficient way of managing role-assignments, when user-numbers are high.</p>
</div>
<div class="paragraph">
<p>To define a group, left-click on the <strong>Add Group</strong> tab, near the upper right of the <strong>Security</strong> screen:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addGroupTab2.png" alt="addGroupTab2" width="210">
</div>
</div>
<div class="paragraph">
<p>This brings up the <strong>Add New Group</strong> dialog:</p>
</div>
<div id="add-new-group-dialog" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addNewGroupDialog71.png" alt="addNewGroupDialog71" width="420">
</div>
</div>
<div class="paragraph">
<p>The fields are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group Name</strong>.
The name of the new Couchbase-Server group to be created.</p>
</li>
<li>
<p><strong>Description</strong>.
An optional description of the new Couchbase-Server group.</p>
</li>
<li>
<p><strong>Map to LDAP Group</strong>.
The name of an existing LDAP group to which the new Couchbase-Server group is to be mapped.
For details, see <a href="configure-ldap.html#map-ldap-groups-to-couchbase-server-roles" class="xref page">Map LDAP Groups to Couchbase Server Roles</a>.</p>
</li>
<li>
<p><strong>Roles</strong>. The roles to be associated with the new Couchbase-Server group.
The display lists role-categories: to see roles, open each category by left-clicking on its right-pointing arrowhead, and scrolling down as appropriate.</p>
<div class="paragraph">
<p>The first category, which appears at the top of the panel, is for <strong>Administrative</strong> roles: these roles involve access to cluster-wide features.</p>
</div>
<div class="paragraph">
<p>Below the first category, the <strong>Bucket</strong>, <strong>Data</strong>, and other categories appear: in most of these categories, roles can be applied to some or all buckets defined on the cluster.
Additionally, within any given bucket, the assigned role can apply to all or to a subset of <em>scopes and collections</em> defined for that bucket (see <a href="../../learn/data/scopes-and-collections.html" class="xref page">Scopes and Collections</a>, for an overview of scopes and collections).</p>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="create-a-group-with-an-administrative-role"><a class="anchor" href="#create-a-group-with-an-administrative-role"></a>Create a Group with an Administrative Role</h4>
<div class="paragraph">
<p>To create a <code>ClusterAdmin</code> group, each of whose members is granted the <strong>Cluster Admin</strong> role, enter the following:</p>
</div>
<div id="add-new-group-dialog-no-mapping" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addNewGroupDialogNoMapping70.png" alt="addNewGroupDialogNoMapping70" width="420">
</div>
</div>
<div class="paragraph">
<p>As this indicates, no LDAP group mapping is required to define a group intended for the support only of users who are defined on Couchbase Server as <em>local</em> or <em>external</em>.
For an explanation of LDAP group mappings, see <a href="configure-ldap.html#map-ldap-groups-to-couchbase-server-roles" class="xref page">Map LDAP Groups to Couchbase Server Roles</a>.</p>
</div>
<div class="paragraph">
<p>Save the group by left-clicking on the <strong>Save</strong> button.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-group-with-a-data-access-role"><a class="anchor" href="#create-a-group-with-a-data-access-role"></a>Create a Group with a Data-Access Role</h4>
<div class="paragraph">
<p>Within each bucket, Couchbase Server organizes data into <em>scopes</em> and <em>collections</em>.
For an overview, see <a href="../../learn/data/scopes-and-collections.html" class="xref page">Scopes and Collections</a>.
Access to each bucket, each scope, and each collection is protected by Role-Based Access Control.
Therefore, roles must be assigned accordingly.</p>
</div>
<div class="paragraph">
<p>To create a group with a data-access role (for example, <strong>Data Reader</strong>), having entered a <strong>Group Name</strong> into the <strong>Add New Group</strong> dialog, access the <strong>Data</strong> category, in the <strong>Roles</strong> panel.
This opens to reveal the available <strong>Data</strong> roles:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/dataCategoryOpen70.png" alt="dataCategoryOpen70" width="240">
</div>
</div>
<div class="paragraph">
<p>Left-click on <strong>Data Reader</strong>, to reveal the selector for role-assignment options:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/dataReaderRoleAssignmentInitial.png" alt="dataReaderRoleAssignmentInitial" width="280">
</div>
</div>
<div class="paragraph">
<p>The selector features three fields: each provides a pull-down menu, from which selections can be made.
The field at the left allows a <em>bucket</em> to be specified; that in the center, a <em>scope</em>; that at the right, a <em>collection</em>.
In each case, the default selection is a wild-card symbol (*), indicating that <em>all</em> are selected by default.</p>
</div>
<div class="paragraph">
<p>Left-click in the left-hand field:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/manage-security/selectBucketForRoleAssignment.png" alt="selectBucketForRoleAssignment" width="280"></span></p>
</div>
<div class="paragraph">
<p>This indicates that three buckets are available for selection: <strong>demoBucket</strong>, <strong>exampleBucket</strong>, and <strong>testBucket</strong>.
Select <strong>testBucket</strong>.
The center field, which has until now been inactive, is activated.
Left-click in the center field to reveal what scopes are available in <strong>testBucket</strong> for assigment:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/manage-security/selectScopeForRoleAssignment.png" alt="selectScopeForRoleAssignment" width="280"></span></p>
</div>
<div class="paragraph">
<p>This shows that the <strong>MyScope</strong> and <strong>_default</strong> scopes are available.
Select <strong>MyScope</strong>.
Now, left-click in the right-hand field:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/manage-security/selectCollectionForRoleAssignment.png" alt="selectCollectionForRoleAssignment" width="280"></span></p>
</div>
<div class="paragraph">
<p>This shows that the <strong>MyCollection</strong> collection is available.
Select <strong>MyCollection</strong>.
Now, to add the assignment of <strong>Data Reader</strong> to all documents in the <strong>MyCollection</strong> collection, in the <strong>MyScope</strong> scope, in the <strong>testBucket</strong> bucket, left click on the <strong>Save</strong> button, at the bottom right of the dialog.
The assigned role now appears immediately below the selector:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/manage-security/addedRole.png" alt="addedRole" width="280"></span></p>
</div>
<div class="paragraph">
<p>To make additional assignments, to other buckets, scopes, and collections, repeat the procedure using the selector.
For each role to be defined, an entry must be specified for each of the three fields&#8201;&#8212;&#8201;bucket, scope, and collection.
Then, the role is displayed as a role-definition, underneath the selector.
Should it be necessary, a displayed role-definition can be deleted, by left-clicking on the <strong>X</strong>, to the right.</p>
</div>
<div class="paragraph">
<p>(Note that some roles apply to all data in the bucket; some to all collections in a specified scope, within a specified bucket; and some to all documents in a specified collection, within a specified scope and bucket.
Consequently, the selector varies in appearance, role by role; based on how many fields are required for the a full specification of the role&#8217;s assignment.)</p>
</div>
<div class="paragraph">
<p>When all required role-definitions have been made, left-click on <strong>Save</strong>, to save the group.
The <strong>Security</strong> screen is now displayed.
The edited group appears, and can always be made visible by means of the <strong>Groups</strong> button.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/manage-security/addedGroupForDataReader.png" alt="addedGroupForDataReader" width="720"></span></p>
</div>
<div class="paragraph">
<p>To make additional changes to the group&#8217;s role-assignments, left click on the <strong>Edit</strong> button.
The <strong>Edit Group &lt;group-name&gt;</strong> dialog appears: this is similar in appearance and behavior to the <strong>Add Group</strong> dialog, and thus allows new roles to be added, and existing to be deleted.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="add-a-user"><a class="anchor" href="#add-a-user"></a>Add a User</h3>
<div class="paragraph">
<p>To add a user, left-click on the <strong class="ui">Add User</strong> control, at the upper right.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addUserTab3.png" alt="addUserTab3" width="210">
</div>
</div>
<div class="paragraph">
<p>The <strong class="ui">Add New User</strong> dialog now appears:</p>
</div>
<div id="manage_user_new" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addNewUserDialogInitial70.png" alt="addNewUserDialogInitial70" width="420">
</div>
</div>
<div class="paragraph">
<p>If either <em>Native LDAP</em> or <code>saslauthd</code> has been enabled, towards the upper left of the dialog, the <strong>Authentication Domain</strong> panel is visible.
This features two checkboxes: one specifying <strong class="ui">Couchbase</strong>, the other <strong class="ui">External</strong>.
By default, <strong class="ui">Couchbase</strong> is checked: this means that the user will be defined locally, and that a password for the user must therefore be created, using the <strong class="ui">Password</strong> fields displayed on the dialog.</p>
</div>
<div class="sect3">
<h4 id="add-a-locally-authenticated-user"><a class="anchor" href="#add-a-locally-authenticated-user"></a>Add a Locally Authenticated User</h4>
<div class="paragraph">
<p>Add a locally authenticated user, by adding appropriate entries into the <strong class="ui">Username</strong> and <strong class="ui">Password</strong> fields.
See <a href="../../learn/security/usernames-and-passwords.html" class="xref page">Usernames and Passwords</a> for character-related requirements.
The <strong class="ui">Full Name</strong> field may be left blank.</p>
</div>
<div class="paragraph">
<p>The user may now either be assigned one or more specific roles, or be assigned to one or more groups (so as to inherit each group&#8217;s assigned roles), or both.</p>
</div>
</div>
<div class="sect3">
<h4 id="adding-roles"><a class="anchor" href="#adding-roles"></a>Assign Roles to a User</h4>
<div class="paragraph">
<p>Roles can be assigned as described above in <a href="#add-a-group">Add a Group</a> &#8212; by checking checkboxes and using selectors, in the <strong class="ui">Roles</strong> panel, which is displayed by default.</p>
</div>
<div class="paragraph">
<p>For example, assign the <strong>Query Curl Access</strong> role:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/addQueryCurlAccessRole70.png" alt="addQueryCurlAccessRole70" width="420">
</div>
</div>
<div class="paragraph">
<p>Now, to add this user, left-click on the <strong>Add User</strong> button, at the lower right of the dialog.
Alternatively, continue the user-definition process, by assigning the user to a group.</p>
</div>
</div>
<div class="sect3">
<h4 id="assigning-groups"><a class="anchor" href="#assigning-groups"></a>Assign a User to a Group</h4>
<div class="paragraph">
<p>To assign a user to a group, left-click on the <strong>Groups</strong> tab at the upper right of the dialog:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/rolesAndGroupsToggle.png" alt="rolesAndGroupsToggle" width="140">
</div>
</div>
<div class="paragraph">
<p>The content of the dialog&#8217;s right-hand pane now changes, to display available groups:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/groupsPanel2.png" alt="groupsPanel2" width="420">
</div>
</div>
<div class="paragraph">
<p>A user-group named <code>ClusterAdmin</code>, is thus shown to exist.
To add the user to the group, check the corresponding checkbox:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/checkCllusterAdmin.png" alt="checkCllusterAdmin" width="240">
</div>
</div>
<div class="paragraph">
<p>Now left-click on the <strong>Add User</strong> button, at the lower right:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/addUserButton.png" alt="addUserButton" width="170">
</div>
</div>
<div class="paragraph">
<p>The new user now appears on <strong>Security</strong> panel, as follows:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/securityScreenWithLocalUser.png" alt="securityScreenWithLocalUser" width="800">
</div>
</div>
<div class="paragraph">
<p>The single, displayed row indicates that user <code>localUser</code> has been defined, and has been granted the <strong>Query CURL Access</strong> role (which was assigned directly) and the <strong>Cluster Admin</strong> role (which has been derived from the user&#8217;s assigned membership of the <strong>ClusterAdmin</strong> group).
Note also that the <strong>auth domain</strong> for the user is <strong>Couchbase</strong>, indicating that this user is locally defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="editing-users-and-groups"><a class="anchor" href="#editing-users-and-groups"></a>Editing Users and Groups</h4>
<div class="paragraph">
<p>Once created, users and groups can be edited.
Left-click on the currently defined user&#8217;s row:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/userSecurityRowClicked.png" alt="userSecurityRowClicked" width="800">
</div>
</div>
<div class="paragraph">
<p>The row expands vertically, displaying control-buttons at the lower right.
By left-clicking on <strong class="ui">Delete</strong>, you delete the user.
By left-clicking on <strong class="ui">Edit</strong>, you bring up the <strong class="ui">Edit &lt;username&gt;</strong> dialog,
which provides options for redefining full name, roles, and groups.
(The content of this dialog is similar to that of the <strong class="ui">Add New User</strong> dialog, examined above.)
The <strong>Reset Password</strong> button only appears when the selected user is
<em>locally</em> defined: left-clicking on this brings up a dialog that allows redefinition of the
user&#8217;s password:</p>
</div>
<div id="reset_password" class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/resetPassword.png" alt="resetPassword" width="260">
</div>
</div>
<div class="paragraph">
<p>Note that the <strong>Users &amp; Groups</strong> panel, subsequent to the definition of a user, displays two buttons towards the upper right, whereby <strong>Users</strong> and <strong>Groups</strong> views can be accessed in turn.
To inspect and make changes to the currently defined group, left-click on the <strong>Groups</strong> button:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/accessGroupsButton.png" alt="accessGroupsButton" width="150">
</div>
</div>
<div class="paragraph">
<p>The <strong>Groups</strong> view is now displayed.
As with the <strong>Users</strong> view, left-clicking on a group&#8217;s row displays controls that include <strong>Delete</strong> and <strong>Edit</strong> options:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/groupSecurityRow.png" alt="groupSecurityRow" width="800">
</div>
</div>
<div class="paragraph">
<p>Left-click on the <strong>Edit</strong> button to display the <strong>Edit Group &lt;group-name&gt;</strong> dialog, which is similar to the <strong>Add New Group</strong>
dialog examined above, and allows all the group&#8217;s attributes, except the name, to be modified.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-an-externally-authenticated-user"><a class="anchor" href="#adding-an-externally-authenticated-user"></a>Adding an Externally Authenticated User</h3>
<div class="paragraph">
<p>An <em>externally authenticated</em> user is not authenticated on Couchbase Server.
Instead, they are authenticated on a server external to the cluster.
This means that the user&#8217;s password is defined and maintained externally.</p>
</div>
<div class="paragraph">
<p>The addition of a user as externally authenticated must be supported by <a href="../../learn/security/authentication-overview.html#native-ldap-support" class="xref page">Native LDAP</a>, <a href="../../learn/security/authentication-overview.html#using-saslauthd" class="xref page">saslauthd</a>, or <a href="../../learn/security/authentication-overview.html#introduction-to-pam-based-authentication" class="xref page">PAM</a>.
Appropriate set-up procedures must have been completed prior to the addition of externally authenticated users.</p>
</div>
<div class="paragraph">
<p>For the detailed steps required to establish external authentication by means of Native LDAP (which is the recommended mechanism), see <a href="configure-ldap.html" class="xref page">Configure LDAP</a>.</p>
</div>
<div class="paragraph">
<p>To add an externally authenticated user, on the <strong>Add New User</strong> dialog, select the <strong>External</strong> option:</p>
</div>
<div class="imageblock text-middle">
<div class="content">
<img src="../_images/manage-security/externalUserRadioButton.png" alt="externalUserRadioButton" width="100">
</div>
</div>
<div class="paragraph">
<p>This removes the password-related fields from the dialog, since they are not required for the creation of an externally authenticated user.
The fields for the user&#8217;s names remain, and can be used.</p>
</div>
<div class="paragraph">
<p>From this point, the externally authenticated user can be defined exactly as was the locally authenticated user, above.
For example, the <strong>Query System Catalog</strong> role can be assigned to the user; and the user then assigned to the <code>ClusterAdmin</code> group, whereby the <strong>Cluster Admin</strong> role is granted.
When the definition-process is complete, the <strong>Users</strong> view of the <strong>Users &amp; Groups</strong> panel appears as follows:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="../_images/manage-security/usersSecurityRows.png" alt="usersSecurityRows" width="800">
</div>
</div>
<div class="paragraph">
<p>The externally authenticated user is now shown to have the username <code>externalUser</code>, and the <strong>Query System Catalog</strong> and <strong>Cluster Admin</strong> roles.
Their <strong>auth domain</strong> is specified as <code>External</code>, indicating that they are authenticated on an external server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>External users can only be authenticated using the <code>PLAIN</code> method.
By default, the Couchbase SDK will only default to PLAIN when connecting over TLS ports, therefore, external users should use the TLS ports.</p>
</div>
<div class="paragraph">
<p>More details on authentication methods can be found in <a href="../../learn/security/authentication-overview.html#authentication-for-applications" class="xref page">Understanding Authentication</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="role-based-console-appearance"><a class="anchor" href="#role-based-console-appearance"></a>Role-Based Console Appearance</h3>
<div class="paragraph">
<p>Role-assignment determines which features of Couchbase Web Console are
available to the administrator.
Non-available features are not displayed: therefore, the console&#8217;s appearance
changes, based on which roles have been assigned the current user.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manage-users-with-the-cli"><a class="anchor" href="#manage-users-with-the-cli"></a>Manage Users with the CLI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Users can be managed with the <a href="#cli:cbcli/couchbase-cli-user-manage.adoc" class="xref unresolved">user-manage</a> command.
This allows the creation and deletion of users and groups, the assignment of roles, and the listing of current status.</p>
</div>
<div class="sect2">
<h3 id="get-user-information-with-the-cli"><a class="anchor" href="#get-user-information-with-the-cli"></a>Get User Information with the CLI</h3>
<div class="paragraph">
<p>To list the cluster&#8217;s current users, enter the following.
Note that the command is piped to the <a href="https://stedolan.github.io/jq/">jq</a> program, to optimize output-readability.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.144.210.101 \
--username Administrator \
--password password \
--list | jq</pre>
</div>
</div>
<div class="paragraph">
<p>A document is returned, containing an entry for each of the current users:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[
  {
    "id": "externalUser",
    "domain": "local",
    "roles": [
      {
        "role": "scope_admin",
        "bucket_name": "demoBucket",
        "scope_name": "demoScope",
        "origins": [
          {
            "type": "user"
          }
        ]
      },
      {
        "role": "ro_admin",
        "origins": [
          {
            "type": "user"
          }
        ]
      }
    ],
    "groups": [],
    "external_groups": [],
    "name": "",
    "password_change_date": "2021-02-01T09:46:04.000Z"
  },
  {
    "id": "testUser",
    "domain": "local",
    "roles": [
      {
        "role": "data_reader",
        "bucket_name": "testBucket",
        "scope_name": "MyScope",
        "collection_name": "MyCollection",
        "origins": [
          {
            "type": "user"
          }
        ]
      }
    ],
    "groups": [],
    "external_groups": [],
    "name": "",
    "password_change_date": "2021-02-01T09:40:23.000Z"
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>The entries include information on the <code>id</code> and <code>roles</code> of the user, their authentication <code>domain</code>, their <code>name</code> if one was specified, and on the local and external <code>groups</code> to which the user belongs.
For each non-global role, the bucket, scope, and collection to which the permissions are restricted are displayed, as appropriate.</p>
</div>
</div>
<div class="sect2">
<h3 id="get-group-information-with-the-cli"><a class="anchor" href="#get-group-information-with-the-cli"></a>Get Group Information with the CLI</h3>
<div class="paragraph">
<p>Information on currently defined <em>groups</em> can similarly be returned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.143.192.101 \
--username Administrator \
--password password \
--list-groups</pre>
</div>
</div>
<div class="paragraph">
<p>An example of the output is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[
  {
    "id": "DataReaderGroup",
    "roles": [
      {
        "role": "data_reader",
        "bucket_name": "testBucket",
        "scope_name": "MyScope",
        "collection_name": "MyCollection"
      },
      {
        "role": "data_reader",
        "bucket_name": "demoBucket",
        "scope_name": "demoScope",
        "collection_name": "demoCollection"
      }
    ],
    "ldap_group_ref": "",
    "description": "Administrators with limited Data Reader permission."
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>This shows that a single group, named <code>DataReaderGroup</code>, has been defined on the cluster; and that the <code>data_reader</code> role has been assigned to it for the specified collections.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-local-users-with-the-cli"><a class="anchor" href="#create-local-users-with-the-cli"></a>Manage Local Users with the CLI</h3>
<div class="paragraph">
<p>The username and password of a <em>local</em> user is stored and maintained on Couchbase Server.
Roles can be allocated to the user either <em>directly</em> or by means of <em>group membership</em>.</p>
</div>
<div class="sect3">
<h4 id="create-a-local-user-using-direct-role-assignment-with-the-cli"><a class="anchor" href="#create-a-local-user-using-direct-role-assignment-with-the-cli"></a>Create a Local User, Using Direct Role-Assignment, with the CLI</h4>
<div class="paragraph">
<p>To create a user who is to be <em>locally authenticated</em>, directly assigning a role, enter the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage \
--cluster http://10.144.210.101 \
--username Administrator \
--password password \
--set \
--rbac-username dgreen \
--rbac-password dGr3En239 \
--roles query_external_access,analytics_reader \
--auth-domain local</pre>
</div>
</div>
<div class="paragraph">
<p>This uses the <code>--set</code> flag, to indicate that the RBAC profile for the cluster is being updated.
The username and password for the user are defined.
The value of the <code>--auth-domain</code> flag indicates that this is indeed to be a <code>local</code> user.
The <code>query_external_access</code> and analytics_reader` roles are assigned by means of the <code>--roles</code> flag: to change direct role assignments, the user must be recreated, with all the new roles specified as the arguments to the <code>--roles</code> flag.</p>
</div>
<div class="paragraph">
<p>If the call is successful, the following is displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>WARNING: Granting the query_external_access role permits execution of the N1QL function CURL() and may allow access to other network endpoints in the local network and the Internet.
SUCCESS: User dgreen set</pre>
</div>
</div>
<div class="paragraph">
<p>The output thus includes the standard command-line warning on the significance of the <code>query_external_access</code> role.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-local-user-with-the-cli-directly-assigning-a-per-collection-role"><a class="anchor" href="#create-a-local-user-with-the-cli-directly-assigning-a-per-collection-role"></a>Create a Local User with the CLI, Directly Assigning a Per-Collection Role</h4>
<div class="paragraph">
<p>Roles that permit data-access can be assigned with reference to a bucket, to a scope within a bucket, or to a collection within a scope.
Syntactically, the assignment should be specified in square brackets, immediately after the role-name; with the bucket-name preceding (if one is specified) the scope-name; and the scope-name preceding (if one is specified) the collection-name.
The names of bucket, scope, and collection must be separated by colons.</p>
</div>
<div class="paragraph">
<p>The following example creates a user whose role permits access to data within a specified collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage \
--cluster http://10.144.210.101 \
--username Administrator \
--password password \
--set \
--rbac-username dhiggins \
--rbac-password d8&amp;3hdli2 \
--roles data_reader[testBucket:my_new_scope:my_new_collection] \
--auth-domain local</pre>
</div>
</div>
<div class="paragraph">
<p>This grants the user <code>dhiggins</code> the <code>data_reader</code> role on data within the collection <code>my_new_collection</code>; which resides within the scope <code>my_new_scope</code>, in the <code>testBucket</code> bucket.</p>
</div>
<div class="paragraph">
<p>If this call is successful, the following is displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User dhiggins set</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-local-user-using-group-based-role-assignment-with-the-cli"><a class="anchor" href="#create-a-local-user-using-group-based-role-assignment-with-the-cli"></a>Create a Local User, Using Group-Based Role-Assignment, with the CLI</h4>
<div class="paragraph">
<p>To create a user who is to be <em>locally authenticated</em>, assigning a role by means of group membership, enter the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.143.192.101 \
--username Administrator \
--password password \
--rbac-username cbrown \
--rbac-password cBr403n438 \
--auth-domain local \
--set \
--user-groups Admins</pre>
</div>
</div>
<div class="paragraph">
<p>This specifies the <code>--set</code> flag, to indicate that group-editing is to occur.
The <code>--user-groups</code> flag is given the value <code>Admins</code>, to indicate that the <code>Admins</code> group is that which will be edited.
Flags are provided to indicate the username and password of a new user, who will be added to the system, and given membership of the specified group, so as to inherit its assigned roles.</p>
</div>
<div class="paragraph">
<p>If successful, the call returns the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User 'cbrown' group memberships were updated</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="delete-a-local-user-with-the-cli"><a class="anchor" href="#delete-a-local-user-with-the-cli"></a>Delete a Local User with the CLI</h4>
<div class="paragraph">
<p>To delete a local user, specify the <code>--delete</code> flag, with the username and authentication domain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.143.192.101 \
--username Administrator \
--password password \
--rbac-username dgreen \
--auth-domain local \
--delete</pre>
</div>
</div>
<div class="paragraph">
<p>The output is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User 'dgreen' was removed</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-group-with-the-cli"><a class="anchor" href="#create-a-group-with-the-cli"></a>Create a Group with the CLI</h4>
<div class="paragraph">
<p>Using the CLI, create a group as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage \
--cluster http://10.143.192.101 \
--username Administrator \
--password password \
--set-group \
--group-name xdcrAdmin \
--roles replication_admin</pre>
</div>
</div>
<div class="paragraph">
<p>This uses the <code>--set-group</code> flag to indicate that a group is to be created or edited.
The <code>--group-name</code> flag specifies the name of a new group named <code>xdcrAdmin</code>, and the <code>--roles</code> flag is used to assign the <code>replication_admin</code> role to the new group.
Note that to change the group&#8217;s role-assignments, the group must be recreated, with all the new role-assignments specified as the arguments to the <code>--roles</code> flag: user-memberships go unchanged.</p>
</div>
<div class="paragraph">
<p>If the call is successful, the following is displayed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: Group 'xdcrAdmin' was created</pre>
</div>
</div>
<div class="paragraph">
<p>For information on how to use the CLI to create a mapping between a Couchbase-Server user-group and an LDAP group, see <a href="configure-ldap.html#map-groups-with-the-cli" class="xref page">Map Groups with the CLI</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-a-group-with-the-cli"><a class="anchor" href="#delete-a-group-with-the-cli"></a>Delete a Group with the CLI</h4>
<div class="paragraph">
<p>To delete a group with the CLI, use the <code>user-manage</code> command as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage \
--cluster http://10.143.192.101 \
--username Administrator \
--password password \
--delete-group \
--group-name xdcrAdmin</pre>
</div>
</div>
<div class="paragraph">
<p>This deletes the group <code>xdcrGroup</code>.
If the command is successful, the following output is provided:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: Group 'xdcrAdmin' was deleted</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="manage-external-users-with-the-cli"><a class="anchor" href="#manage-external-users-with-the-cli"></a>Manage External Users with the CLI</h3>
<div class="paragraph">
<p>Users can be defined as <em>externally authenticated</em>, by means of the CLI.
This requires external authentication to have been configured prior to user-creation.
For recommended procedures, see <a href="configure-ldap.html" class="xref page">Configure LDAP</a>.</p>
</div>
<div class="sect3">
<h4 id="create-an-external-user-using-direct-role-assignment-with-the-cli"><a class="anchor" href="#create-an-external-user-using-direct-role-assignment-with-the-cli"></a>Create an External User, Using Direct Role-Assignment, with the CLI</h4>
<div class="paragraph">
<p>To create an <em>externally authenticated</em> user with direct role-assignment, use the <code>user-manage</code> command as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.143.192.101 \
--username Administrator \
--password password \
--set \
--rbac-username wgrey \
--roles cluster_admin \
--auth-domain external</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--auth-domain</code> is specified as <code>external</code>.
The <code>--set</code> flag establishes that the cluster&#8217;s RBAC profile is to be updated.
No password is specified, since none is to be saved on Couchbase Server &#8212; authentication occurring on the LDAP server.
The role to be assigned to the user is specified by means of the <code>--roles</code> flag as <code>cluster_admin</code></p>
</div>
<div class="paragraph">
<p>If the command is successful, the following is returned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User wgrey was created</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-an-external-user-directly-assigning-a-per-collection-role"><a class="anchor" href="#create-an-external-user-directly-assigning-a-per-collection-role"></a>Create an External User, Directly Assigning a Per-Collection Role</h4>
<div class="paragraph">
<p>Roles that permit data-access can be assigned with reference to a bucket, to a scope within a bucket, or to a collection within a scope.
Syntactically, the assignment should be specified in square brackets, immediately after the role-name; with the bucket-name preceding (if one is specified) the scope-name; and the scope-name preceding (if one is specified) the collection-name.
The names of bucket, scope, and collection must be separated by colons.</p>
</div>
<div class="paragraph">
<p>The following example creates an external user whose role permits access to data within a specified collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.144.210.101 \
--username Administrator \
--password password \
--set \
--rbac-username tcrawford \
--roles data_writer[testBucket:my_new_scope:my_new_collection] \
--auth-domain external</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User tcrawford set</pre>
</div>
</div>
<div class="paragraph">
<p>External user <code>tcrawford</code> is thus granted <code>data_writer</code> access to the collection <code>my_new_collection</code>; which resides in the scope <code>my_new_scope</code>, in the bucket <code>testBucket</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-an-external-user-using-group-based-role-assignment-with-the-cli"><a class="anchor" href="#create-an-external-user-using-group-based-role-assignment-with-the-cli"></a>Create an External User, Using Group-Based Role-Assignment, with the CLI</h4>
<div class="paragraph">
<p>To create an external user with a group-based role-assignment, use the <code>user-manage</code> command as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.143.192.101 \
--username Administrator \
--password password \
--set \
--rbac-username rjones \
--rbac-name 'Richard Jones' \
--auth-domain external \
--user-groups Admins</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--set</code> flag specifies that a group is to be updated.
The existing Couchbase-Server user-group <code>Admins</code> is passed as the value of <code>--user-groups</code>: this specifies that <code>Admins</code> is indeed the group of which the external user, <code>rjones</code> is to be a member.
All roles assigned to <code>Admins</code> are now to be inherited by <code>rjones</code>.</p>
</div>
<div class="paragraph">
<p>If successful, the command returns the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User 'rjones' group memberships were updated</pre>
</div>
</div>
<div class="paragraph">
<p>For information on how to use the CLI to create a mapping between a Couchbase-Server user-group and an LDAP group, see <a href="configure-ldap.html#map-groups-with-the-cli" class="xref page">Map Groups with the CLI</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-an-external-user-with-the-cli"><a class="anchor" href="#delete-an-external-user-with-the-cli"></a>Delete an External User with the CLI</h4>
<div class="paragraph">
<p>To delete an external user, use the <code>--delete-user</code> flag, specifying <code>external</code> as the value of the <code>--auth-domain</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage --cluster http://10.143.192.101 \
--username Administrator \
--password password \
--rbac-username wgrey \
--auth-domain external \
--delete</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the command returns the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User 'wgrey' was removed</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manage-users-with-the-rest-api"><a class="anchor" href="#manage-users-with-the-rest-api"></a>Manage Users with the REST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Users can be managed with the <code>GET /settings/rbac/users</code> method and URI.
This allows the creation and deletion of users and groups, the assignment of roles, and the listing of current status.</p>
</div>
<div class="paragraph">
<p>For corresponding reference information, see <a href="../../rest-api/rbac.html" class="xref page">Role Based Admin Control (RBAC)</a>.</p>
</div>
<div class="paragraph">
<p>Each user can be defined as either <em>locally</em> or <em>externally</em>.
The creation of external users requires external authentication to have been configured prior to user-creation.
For recommended procedures, see <a href="configure-ldap.html" class="xref page">Configure LDAP</a>.</p>
</div>
<div class="sect2">
<h3 id="get-user-information-with-the-rest-api"><a class="anchor" href="#get-user-information-with-the-rest-api"></a>Get User Information with the REST API</h3>
<div class="paragraph">
<p>To list the cluster&#8217;s current users, use the <code>GET /settings/rbac/users</code> method and URI as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X GET -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the command provides as its output a document containing an entry for each of the current users.
This output is identical in form to that shown above, in <a href="#get-user-information-with-the-cli">Get User Information with the CLI</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="get-group-information-with-the-rest-api"><a class="anchor" href="#get-group-information-with-the-rest-api"></a>Get Group Information with the REST API</h3>
<div class="paragraph">
<p>To list the cluster&#8217;s current groups, use the <code>GET /settings/rbac/groups</code> method and URI as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X GET -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/groups</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the command provides as its output a document containing an entry for each of the current groups.
This output is identical in form to that shown above, in <a href="#get-group-information-with-the-cli">Get Group Information with the CLI</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="manage-local-users-with-the-rest-api"><a class="anchor" href="#manage-local-users-with-the-rest-api"></a>Manage Local Users with the REST API</h3>
<div class="paragraph">
<p>The username and password of a local user is stored and maintained on Couchbase Server. Roles can be allocated to the user either directly or by means of group membership.</p>
</div>
<div class="sect3">
<h4 id="create-a-local-user-with-the-rest-api"><a class="anchor" href="#create-a-local-user-with-the-rest-api"></a>Create a Local User, Using Direct Role-Assignment, with the REST API</h4>
<div class="paragraph">
<p>To create a local user, use the <code>PUT /settings/rbac/users/local/&lt;username&gt;</code> method and URI.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X  PUT -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users/local/dgreen \
-d password=dGr3En238 \
-d roles=ro_admin</pre>
</div>
</div>
<div class="paragraph">
<p>This specifies that the user <code>dgreen</code> should be locally established, with the given password and the <code>ro_admin</code> role.</p>
</div>
<div class="paragraph">
<p>If required, the <code>GET /settings/rbac/users</code> method and URI (described above) can now be used to verify that the specified user has been added.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-local-user-directly-assigning-a-per-collection-role"><a class="anchor" href="#create-a-local-user-directly-assigning-a-per-collection-role"></a>Create a Local User, Directly Assigning a Per-Collection Role</h4>
<div class="paragraph">
<p>Roles that permit data-access can be assigned with reference to a bucket, to a scope within a bucket, or to a collection within a scope.
Syntactically, the assignment should be specified in square brackets, immediately after the role-name; with the bucket-name preceding (if one is specified) the scope-name; and the scope-name preceding (if one is specified) the collection-name.
The names of bucket, scope, and collection must be separated by colons.
The following example creates a user whose role permits access to data within a specified collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X  PUT -u Administrator:password \
http://10.144.210.101:8091/settings/rbac/users/local/dwilliams \
-d password=dGr3En238 \
-d roles=data_reader[testBucket:my_new_scope:my_new_collection]</pre>
</div>
</div>
<div class="paragraph">
<p>The user <code>dwilliams</code> is thus granted <code>data_reader</code> privileges on the collection <code>my_new_collection</code>; which resides within the scope <code>my_new_scope</code>, in the <code>testBucket</code> bucket.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-a-local-user-using-group-based-role-assignment-with-the-rest-api"><a class="anchor" href="#create-a-local-user-using-group-based-role-assignment-with-the-rest-api"></a>Create a Local User, Using Group-Based Role-Assignment, with the REST API</h4>
<div class="paragraph">
<p>Use the <code>PUT /settings/rbac/users/local/sdavis</code> method and URI, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X  PUT -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users/local/sdavis \
-d groups=Admins,xdcrAdmin \
-d password=Sd4v1s938</pre>
</div>
</div>
<div class="paragraph">
<p>The value of the <code>--groups</code> flag specifies that the user, specified in the endpoint as <code>sdavis</code>, should be added to the <code>Admins</code> and <code>xdcrAdmin</code> groups.
To modify group membership subsequently, run the command again, specifying all of the groups whose membership is required as the arguments to the <code>groups</code> parameter.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-a-local-user-with-the-rest-api"><a class="anchor" href="#delete-a-local-user-with-the-rest-api"></a>Delete a Local User with the REST API</h4>
<div class="paragraph">
<p>Local users can be deleted by means of the <code>DELETE /settings/rbac/users/local/&lt;username&gt;</code> method and URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X DELETE -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users/local/dgreen</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-group-with-the-rest-api"><a class="anchor" href="#create-a-group-with-the-rest-api"></a>Create a Group with the REST API</h4>
<div class="paragraph">
<p>To create a group with the REST API, use the <code>PUT /settings/rbac/groups/&lt;group-name&gt;</code> method and URI.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X PUT -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/groups/roAdminGroup \
-d roles=ro_admin</pre>
</div>
</div>
<div class="paragraph">
<p>This establishes a new group named <code>roAdminGroup</code>.
By means of the <code>roles</code> parameter, the <code>ro_admin</code> role is assigned to the group.
This role will be inherited by all of the group&#8217;s future members.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-a-group-with-the-rest-api"><a class="anchor" href="#delete-a-group-with-the-rest-api"></a>Delete a Group with the REST API</h4>
<div class="paragraph">
<p>To delete a group with the REST API, use the <code>DELETE /settings/rbac/groups/&lt;group-name&gt;</code> method and URI.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X DELETE -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/groups/roAdminGroup</pre>
</div>
</div>
<div class="paragraph">
<p>This deletes the group <code>roAdminGroup</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="manage-external-users-with-the-rest-api"><a class="anchor" href="#manage-external-users-with-the-rest-api"></a>Manage External Users with the REST API</h3>
<div class="paragraph">
<p>Users can be defined as <em>externally authenticated</em>, by means of the REST API.
This requires external authentication to have been configured prior to user-creation.
For recommended procedures, see <a href="configure-ldap.html" class="xref page">Configure LDAP</a>.</p>
</div>
<div class="sect3">
<h4 id="create-an-external-user-with-direct-role-assignment-using-the-rest-api"><a class="anchor" href="#create-an-external-user-with-direct-role-assignment-using-the-rest-api"></a>Create an External User, Using Direct Role-Assignment, with the REST API</h4>
<div class="paragraph">
<p>To create an external user and assign roles to them directly, use the <code>PUT /settings/rbac/users/external/&lt;username&gt;</code> method and URI.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X PUT -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users/external/wgrey \
-d roles=cluster_admin</pre>
</div>
</div>
<div class="paragraph">
<p>This creates the externally authenticated user <code>wgrey</code>, and assigns them the <code>cluster_admin</code> role.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-an-external-user-directly-assigning-a-per-collection-role-2"><a class="anchor" href="#create-an-external-user-directly-assigning-a-per-collection-role-2"></a>Create an External User, Directly Assigning a Per-Collection Role</h4>
<div class="paragraph">
<p>Roles that permit data-access can be assigned with reference to a bucket, to a scope within a bucket, or to a collection within a scope.
Syntactically, the assignment should be specified in square brackets, immediately after the role-name; with the bucket-name preceding (if one is specified) the scope-name; and the scope-name preceding (if one is specified) the collection-name.
The names of bucket, scope, and collection must be separated by colons.
The following example creates an external user whose role permits access to data within a specified collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/opt/couchbase/bin/couchbase-cli user-manage \
--cluster http://10.144.210.101 \
--username Administrator \
--password password \
--set \
--rbac-username tcrawford \
--roles data_writer[testBucket:my_new_scope:my_new_collection] \
--auth-domain external</pre>
</div>
</div>
<div class="paragraph">
<p>If successful, the call returns the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SUCCESS: User tcrawford set</pre>
</div>
</div>
<div class="paragraph">
<p>External user <code>tcrawford</code> is thus granted <code>data_writer</code> access to the collection <code>my_new_collection</code>; which resides in the scope <code>my_new_scope</code>, in the bucket <code>testBucket</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-an-external-user-with-a-group-mapping-with-the-rest-api"><a class="anchor" href="#create-an-external-user-with-a-group-mapping-with-the-rest-api"></a>Create an External User, Using Group-Based Role-Assignment, with the REST API</h4>
<div class="paragraph">
<p>Use the <code>PUT /settings/rbac/users/&lt;name&gt;</code> method and URI, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X PUT -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users/rjones \
-d groups=Admins,xdcrAdmin</pre>
</div>
</div>
<div class="paragraph">
<p>This adds the externally authenticated user <code>rjones</code> to the cluster&#8217;s <code>Admins</code> and <code>xdcrAdmins</code> groups.
The user now inherits the roles that have been assigned to each of the groups.</p>
</div>
</div>
<div class="sect3">
<h4 id="delete-an-external-user-with-the-rest-api"><a class="anchor" href="#delete-an-external-user-with-the-rest-api"></a>Delete an External User with the REST API</h4>
<div class="paragraph">
<p>External users can be deleted by means of the <code>DELETE /settings/rbac/users/external/&lt;username&gt;</code> method and URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -v -X DELETE -u Administrator:password \
http://10.143.192.101:8091/settings/rbac/users/external/wgrey</pre>
</div>
</div>
<div class="paragraph">
<p>This deletes the external user <code>wgrey</code> from the cluster.</p>
</div>
<div class="paragraph">
<p>For more information on managing users, groups, and roles with the REST API, see <a href="../../rest-api/rbac.html" class="xref page">Role Based Admin Control (RBAC)</a>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../../_/js/site.js"></script>
<script defer src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
</body>
</html>
