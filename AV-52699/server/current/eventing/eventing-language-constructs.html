<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Language Constructs | Couchbase Docs</title>
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="The language constructs are fundamental units of a language.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.2">
<meta name="page-url" content="/server/current/eventing/eventing-language-constructs.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="2">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/tony.hillman/Documents/71docs/docs-server/modules/eventing/pages/eventing-language-constructs.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb"><a href="eventing-language-constructs.html">Language Constructs</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Language Constructs</h1>
<div class="labels">
<ul></ul>
</div>
<div class="labels">
<ul>
<li class="edition"><a href="https://www.couchbase.com/products/editions">Enterprise Edition</a></li>
</ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
The language constructs are fundamental units of a language.
This topic discusses the JavaScript constructs that have been removed and new constructs that have been added in order to support the requirements of Couchbase Functions.
</blockquote>
</div>
<div class="paragraph">
<p>Using JavaScript, you can write your custom Functions.
Couchbase Functions inherit support for most ECMAScript constructs by using Google v8 as the execution container.
However, to support the ability to shard and scale Function-execution automatically, some capabilities have been removed.
Additionally, to optimize language-utilization of the server environment, some new constructs have been added.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While every effort is made to ensure the accuracy of the content of the Eventing documentation herein, it should be noted that the controlling technical document is the <a href="https://github.com/couchbase/eventing/blob/master/docs/specification-70.pdf">Couchbase 7.0 Eventing Specification</a> available on GitHub.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="removed-lang-features"><a class="anchor" href="#removed-lang-features"></a>Removed Language Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following JavaScript features have been removed and cannot be used in Eventing Functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#global_state">Global State</a></p>
</li>
<li>
<p><a href="#asynchrony">Asynchrony</a></p>
</li>
<li>
<p><a href="#browser_extensions">Browser and other Extensions</a></p>
</li>
<li>
<p><a href="#library_imports">Library Imports</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="global_state"><a class="anchor" href="#global_state"></a>Global State</h3>
<div class="paragraph">
<p>Eventing Functions do not allow global variables. All state must be saved and retrieved from persistence providers. In Couchbase Server, the Data Service is used as a persistence provider. Therefore, all global states are contained in the Data Service bucket(s) made available to the Eventing Functions through bindings. This restriction is mandatory for the Eventing Function logic to remain agnostic of the rebalance operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">var count = 0;                         // Not allowed - global variable.
function OnUpdate(doc, meta) {
  count++;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the use of 'Constant alias' bindings in the Function&#8217;s settings can be used to provide global constants accessible within a Function&#8217;s JavaScript.  For example you might have a Constant alias of <em>debug</em> with a value of <em>true</em> (or <em>false</em>) to control verbose logging this would behave just like adding a statement <code>const debug = true;</code> at the beginning of your JavaScript code.</p>
</div>
</div>
<div class="sect2">
<h3 id="asynchrony"><a class="anchor" href="#asynchrony"></a>Asynchrony</h3>
<div class="paragraph">
<p>Asynchrony, particularly asynchronous callbacks, to be useful needs to retain access to their parent scope. As such asynchrony forms a node specific, long-running state that prevents the capture of the entire state in the persistence providers. Therefore, Eventing Functions are restricted to executing as short-running, straight-line code, without sleep and wakeups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
  setTimeout(function(){}, 300);     // Not allowed - asynchronous flow.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Limited asynchrony is added back through time observers (or Timers). Time observers are designed specifically not to make the state node specific.</p>
</div>
</div>
<div class="sect2">
<h3 id="browser_extensions"><a class="anchor" href="#browser_extensions"></a>Browser and other Extensions</h3>
<div class="paragraph">
<p>Eventing Functions execute as server-side code on Couchbase Server similar to the JavaScript code that is used in browsers.</p>
</div>
<div class="paragraph">
<p>Because Eventing Functions do not execute in the context of a browser, the extensions that browsers add to the core language, such as window methods, DOM events etc. are not available. The Couchbase Server prevents these browser extensions from executing in an Eventing Function.  However a limited subset is added back (such as function timers in lieu of setTimeout, and curl calls in lieu of XHR).</p>
</div>
<div class="paragraph">
<p>For example some code that runs in the browser is excluded from use in Eventing Functions. The ‘window’ term in the code <strong>window.XMLHttpRequest()</strong>, is not a server-side construct but is in the context of a browser and as such is not available to your Eventing Functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
  var rpc = window.XMLHttpRequest();  // Not allowed - browser extension.
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="library_imports"><a class="anchor" href="#library_imports"></a>Library Imports</h3>
<div class="paragraph">
<p>Eventing service restricts importing libraries into eventing functions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="added-lang-features"><a class="anchor" href="#added-lang-features"></a>Added Language Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following constructs have been added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#bucket_accessors">Basic Keyspace Accessors</a></p>
</li>
<li>
<p><a href="#advanced_bucket_accessors">Advanced Keyspace Accessors</a></p>
</li>
<li>
<p><a href="#logging">Logging</a></p>
</li>
<li>
<p><a href="#n1ql_statements">SQL++ Statements</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="bucket_accessors"><a class="anchor" href="#bucket_accessors"></a>Basic Keyspace Accessors</h3>
<div class="paragraph">
<p>Couchbase buckets, when bound to a Function, appear as a global JavaScript map.
The map operations such as get, set and delete are exposed to the Data Service providers get, set, and delete operations respectively.</p>
</div>
<div class="paragraph">
<p>Note, if the bucket binding has a wild card of <code>*</code> for the scope and/or the collection you can not use a basic keyspace accessors but must use the advanced bucket accessors to access the Data Service.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
  // Assuming 'dest' is a bucket alias or binding to a keyspace
  var val = dest[meta.id];         // this is a bucket GET operation.
  dest[meta.id] = {"status":3};    // this is a bucket SET operation.
  delete dest[meta.id];            // this is a bucket DEL operation.
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The GET operation</strong> <em>(operator [] applied on a bucket binding and used as a value expression)</em></p>
<div class="paragraph">
<p>This fetches the corresponding object from the KV bucket the variable is bound to, and returns the parsed JSON value as a JavaScript object. Fetching a non-existent object from a bucket will return JavaScript undefined value. This operation throws an exception if the underlying bucket GET operation fails with an unexpected error.</p>
</div>
</li>
<li>
<p><strong>The SET operation</strong> <em>(operator [] appearing on left of = assignment statement)</em></p>
<div class="paragraph">
<p>This sets the provided JavaScript value into the KV bucket the variable is bound to, replacing any existing value with the specified key. This operation throws an exception if the underlying bucket SET operation fails with an unexpected error.</p>
</div>
</li>
<li>
<p><strong>The DELETE operation</strong> <em>(operator [] appearing after JavaScript delete keyword)</em></p>
<div class="paragraph">
<p>This deletes the provided key from the KV bucket the variable is bound to. If the object does not exist, this call is treated as a no-op. This operation throws an exception if the underlying bucket DELETE operation fails with an unexpected error.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="advanced_bucket_accessors"><a class="anchor" href="#advanced_bucket_accessors"></a>Advanced Keyspace Accessors</h3>
<div class="paragraph">
<p>The following advanced bucket accessors have been added to expose a richer set of options and operators.
Unlike the basic bucket accessors these operations have non-trivial argument sets and return values for complete details refer to <a href="eventing-advanced-keyspace-accessors.html" class="xref page">Advanced Keyspace Accessors Details</a>.</p>
</div>
<div class="paragraph">
<p>Note, if the bucket binding has a wild card of <code>*</code> for the scope and/or the collection you must also provide <em>meta.keyspace</em> in addition to <em>meta.id</em> in the <em>meta</em> object.</p>
</div>
<div id="advanced-get-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced GET operation</strong>: <em>result = couchbase.get(binding, meta)</em></p>
<div class="paragraph">
<p>This operation allows reading a document from the bucket with an ability to specify the CAS value to be matched during the read.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-get-op" class="xref page">advanced GET operation</a>.</p>
</div>
</li>
</ul>
</div>
<div id="advanced-insert-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced INSERT operation</strong>: <em>result = couchbase.insert(binding, meta, doc)</em></p>
<div class="paragraph">
<p>This operation allows creating a fresh document in the bucket.
This operation will fail if the document with the specified key already exists.
It allows specifying an expiration time (or TTL) to be set on the document.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-insert-op" class="xref page">advanced INSERT operation</a>.</p>
</div>
</li>
</ul>
</div>
<div id="advanced-upsert-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced UPSERT operation</strong>: <em>result = couchbase.upsert(binding, meta, doc)</em></p>
<div class="paragraph">
<p>This operation allows updating an existing document in the bucket, or if absent, creating a fresh document with the specified key.
The operation does not allow specifying CAS (it will silently ignore it).
It also allows specifying an expiration time (or TTL) to be set on the document.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-upsert-op" class="xref page">advanced UPSERT operation</a>.</p>
</div>
</li>
</ul>
</div>
<div id="advanced-replace-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced REPLACE operation</strong>: <em>result = couchbase.replace(binding, meta, doc)</em></p>
<div class="paragraph">
<p>This operation replaces an existing document in the bucket
This operation will fail if the document with the specified key does not exist.
This operation allows specifying a CAS value that must be matched as a pre-condition before proceeding with the operation.
It also allows specifying an expiration time (or TTL) to be set on the document.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-replace-op" class="xref page">advanced REPLACE operation</a>.</p>
</div>
</li>
</ul>
</div>
<div id="advanced-delete-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced DELETE operation</strong>: <em>result = couchbase.delete(binding, meta)</em></p>
<div class="paragraph">
<p>This operation allows deleting a document in the bucket specified by key.
Optionally, a CAS value may be specified which will be matched as a pre-condition to proceed with the operation.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-delete-op" class="xref page">advanced DELETE operation</a>.</p>
</div>
</li>
</ul>
</div>
<div id="advanced-increment-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced INCREMENT operation</strong>: <em>result = couchbase.incrment(binding, meta)</em></p>
<div class="paragraph">
<p>This operation atomically increments the field <em>"count"</em> in the specified document.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-increment-op" class="xref page">advanced INCREMENT operation</a>.</p>
</div>
<div class="paragraph">
<p>The document must have the below structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{"count": 23} // 23 is the current counter value</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>increment</em> operation returns the post-increment value.</p>
</div>
<div class="paragraph">
<p>If the specified counter document does not exist, one is created with <em>count</em> value as 0 and the structure noted above. And so, the first returned value will be 1.</p>
</div>
<div class="paragraph">
<p>Due to limitations in KV engine API, this operation cannot currently manipulate full document counters.</p>
</div>
</li>
</ul>
</div>
<div id="advanced-decrement-op" class="ulist">
<ul>
<li>
<p><strong>The Advanced DECREMENT operation</strong>: <em>result = couchbase.decrement(binding, meta)</em></p>
<div class="paragraph">
<p>This operation atomically decrements the field <em>"count"</em> in the specified document.
For more information see <a href="eventing-advanced-keyspace-accessors.html#advanced-decrement-op" class="xref page">advanced DECREMENT operation</a>.</p>
</div>
<div class="paragraph">
<p>The document must have the below structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{"count": 23} // 23 is the current counter value</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>decrement</em> operation returns the post-decrement value.</p>
</div>
<div class="paragraph">
<p>If the specified counter document does not exist, one is created with <em>count</em> value as 0 and the structure noted above. And so, the first returned value will be -1.</p>
</div>
<div class="paragraph">
<p>Due to limitations in KV engine API, this operation cannot currently manipulate full document counters.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="logging"><a class="anchor" href="#logging"></a>Logging</h3>
<div class="paragraph">
<p>An additional function, log() has been introduced to the language, which allows Eventing Functions to log user defined messages. These log() statements will go the specific Eventing Function&#8217;s log file also known as the application log.
The messages go files located in the Eventing data directory and do not contain any system log messages.
The function takes a string to write to the file. If non-string types are passed, a best effort string representation will be logged, but the format of these may change over time.
This function does not throw exceptions.
For more information see <a href="eventing-debugging-and-diagnosability.html#application-logs" class="xref page">application logs</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
  log("Now processing: " + meta.id);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Eventing Service also creates a system log file named <strong>eventing.log</strong> common across all Eventing Functions to capture management and lifecycle information, however the end-user cannot write to this file.
For more information see <a href="eventing-debugging-and-diagnosability.html#system-log" class="xref page">system log</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="n1ql_statements"><a class="anchor" href="#n1ql_statements"></a>SQL++ Statements</h3>
<div class="paragraph">
<p>Top level SQL++ keywords, such as SELECT, UPDATE, INSERT and DELETE, are available as inline keywords in Eventing Functions. Operations that return values such as SELECT are accessible through a returned iterable handle. SQL++ Query results, via a SELECT, are streamed in batches to the iterable handle as the iteration progresses through the result set.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SQL++ DML statements cannot manipulate documents in the same bucket as the Eventing Function is listening for mutations on to avoid recursion. Workaround: use the exposed data service KV map in your Eventing function.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JavaScript variables can be referred by SQL++ statements using <strong>$&lt;variable&gt;</strong> syntax. Such parameters will be substituted with the corresponding JavaScript variable&#8217;s runtime value using SQL++ named parameters substitution facility.</p>
</div>
<div class="paragraph">
<p>When deploying the below Function with a feed boundary of "Everything" the same SQL++ statement will execute 7,303 times. If the feed boundary is configured to "From now" and you then mutate just one (1) document in the keyspace <code>beer-sample</code>.<code>_default</code>.<code>_default</code> only one (1) query will be executed.  Also keep in mind that adding an optimal index can speed up the query performance by 24X.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
    var strong = 70;
    var results =
        SELECT *                               /* SQL++ queries are embedded directly.    */
        FROM `beer-sample`._default._default   /* Token escaping is standard SQL++ style. */
        WHERE abv &gt; $strong;                   // Local variable reference using $ syntax.
    for (var beer of results) {                // Stream results using 'for' iterator.
        log(beer);
        break;
    }
    results.close();                           // End the query and free resources held
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The embedded SQL++ call starts the query and returns a JavaScript Iterable object representing the result set of the query. The query is streamed in batches as the iteration proceeds. The returned handle can be iterated using any standard JavaScript mechanism including <em>for&#8230;&#8203;of</em> loops.</p>
</div>
<div class="paragraph">
<p>In multiline SQL++ statements (as above) you cannot use single line <code class="var">// end of line comments like this</code><br>
prior to the terminating semicolon as it will cause a syntax error in the transpilation of the SQL++ statement, however multiline <code class="var">/* comments like this */</code> are allowed.</p>
</div>
<div class="paragraph">
<p>The iterator is an input iterator (elements are read-only). The keyword <em>this</em> cannot be used in the body of the iterator. The variables created inside the iterator are local to the iterator.</p>
</div>
<div class="paragraph">
<p>The returned handle must be closed using the <code class="var">close()</code> method defined on it, which stops the underlying SQL++ query and releases associated resources.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When an Eventing Function completes for a given mutation and exits all resources will be freed even if you omit the <code class="var">close()</code> statement for your result set(s). However in some complex use cases such as nested SQL++ lookups a failure to explicitly call <code class="var">close()</code> after each result set is no longer needed can tie up an excessive amount of SQL++ resources and lead to poor performance.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All three operations, i.e., the SQL++ statement, iterating over the result set, and closing the Iterable handle can throw exceptions if unexpected error arises from the underlying SQL++ query.</p>
</div>
<div class="paragraph">
<p>As SQL++ is not syntactically part of the JavaScript language, the Eventing Function code is transpiled to identify valid SQL++ statements which are then converted to a standard JavaScript function call that returns an Iterable object with addition of a <code class="var">close()</code> method.</p>
</div>
<div class="paragraph">
<p>You must use <code class="var">$&lt;variable&gt;</code>, as per SQL++ specification, to use a JavaScript variable in the query statement.
The object expressions for substitution are not supported and therefore you cannot use the <code class="param">meta.id</code> expression in the query statement.</p>
</div>
<div class="paragraph">
<p>Instead of <code class="param">meta.id</code> expression, you can use <code>var id = meta.id</code> in an SQL++ query.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Invalid SQL++ Statement</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">DELETE FROM mybucket.myscope.transactions WHERE username = $meta.id;</code></pre>
</div>
</div>
</li>
<li>
<p>Valid SQL++ Statement</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">var id = meta.id;
DELETE FROM mybucket.myscope.transactions WHERE username = $id;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you use a SQL++ query inside a Eventing Function, remember to use an escaped identifier for keyspaces (bucket.scope.collection) with special characters
(`<code class="param">bucket-name</code>`).
Escaped identifiers are surrounded by back ticks and support all identifiers in JSON</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the bucket name is <code class="param">beer-sample</code> and the scope and collection are both _default, then only the bucket in the SQL++ needs to be escaped:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT * FROM `beer-sample`._default._default WHERE type ...</code></pre>
</div>
</div>
</li>
<li>
<p>However if the bucket name was <code class="param">beersample</code>, then the keyspace of the SQL++ query needs no escaping:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sqlpp hljs" data-lang="sqlpp">SELECT * FROM beersample._default._default WHERE type ...</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build-in-functions"><a class="anchor" href="#build-in-functions"></a>Built-in Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following built in functions have been added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#n1ql_call">The N1QL() function call</a></p>
</li>
<li>
<p><a href="#crc64_call">The crc64() function call</a></p>
</li>
<li>
<p><a href="#createtimer_call">The createTimer() function call</a></p>
</li>
<li>
<p><a href="#canceltimer_call">The cancelTimer() function call</a></p>
</li>
<li>
<p><a href="#curl_call">The curl() function call</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="n1ql_call"><a class="anchor" href="#n1ql_call"></a>The N1QL() Function Call</h3>
<div class="paragraph">
<p>The <em>N1QL()</em> function call  is documented below for reference purposes but should not used directly as doing so would bypass the various semantic and syntactic checks of the transpiler (notably: recursive mutation checks will no longer function, and the statement will need to manual escaping of all SQL++ special sequences and keywords).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In addition the <em>N1qlQuery()</em> is now deprecated and has been replaced with the <em>N1QL()</em> call which has a different parameter format.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><em>statement</em></p>
<div class="paragraph">
<p>This is the identified SQL++ statement. This will be passed to SQL++ via SDK to run as a prepared statement. All referenced JS variables in the statement (using the $var notation) will be treated by SQL++ as named parameters.</p>
</div>
</li>
<li>
<p><em>params</em></p>
<div class="paragraph">
<p>This can be either a JavaScript array (for positional parameters) or a JavaScript map. When the SQL++ statement utilizes positional parameters (i.e., $1, $2 &#8230;&#8203;), then params is expected to be a JavaScript array corresponding to the values to be bound to these positional parameters. When the SQL++ statement utilizes named parameters (i.e., $name), then params is expected to be a JavaScript map object providing the name-value pairs corresponding to the variables used by the SQL++ statement. Positional and named value parameters cannot be mixed.</p>
</div>
<div class="paragraph">
<p>Note, adding an optimal index to the <code>travel-sample</code>.<code>_default.`_default</code> keyspace for the below query can increase the performance by 57X.</p>
</div>
<div class="paragraph">
<p><em>iterator using a positional params array</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    // Using `travel-sample`._default._default to demonstrate params.
    // a) Positional param 1 is field 'iata' from the input doc
    // b) Positional param 2 from an Eventing Function variable: max_dist
    // c) Will also prepare the statement for better performance

    if (doc.type !== "airline") return; // only process airline docs

    var max_dist = 120;
    var results = N1QL(
        "SELECT COUNT(*) AS cnt " +
        "FROM `travel-sample`._default._default " +
        "WHERE type = \"route\" " +
        "AND airline = $1 AND distance &lt;= $2",
        [doc.iata,max_dist],
        { 'isPrepared': true }
    );</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Example iterator using a named params object</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">    // Using `travel-sample`._default._default to demonstrate named params.
    // a) Named param 1 '$mytype' is a hardcode
    // b) Named param 2 '$myairline' is field 'iata' from the input doc
    // c) Named param 3 '$mydistance' if from an Eventing Function variable max_dist
    // d) Set the consistency in the options to none

    if (doc.type !== "airline") return; // only process airline docs

    var max_dist = 120;
    var results = N1QL("SELECT COUNT(*) AS cnt " +
        "FROM `travel-sample`._default._default " +
        "WHERE type = $mytype " +
        "AND airline = $myairline AND distance &lt;= $mydistance",
        { '$mytype': 'route', '$mydistance': max_dist, '$myairline': doc.iata },
        { 'consistency': 'none' }
    );</code></pre>
</div>
</div>
</li>
<li>
<p><em>options</em></p>
<div class="paragraph">
<p>This is a JSON object having various query runtime options as keys. Currently, the following settings are recognized:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>isPrepared</em></p>
<div class="paragraph">
<p>This controls if the statement will be prepared. Normally, this defaults to <em>false</em> but can be set on a per statement basis to <em>true</em> for any SQL++ query that needs increased performance.</p>
</div>
</li>
<li>
<p><em>consistency</em></p>
<div class="paragraph">
<p>This controls the consistency level for the statement. Normally, this defaults to the consistency level specified in the overall Eventing Function settings but can be set on a per statement basis. The valid values are "none" and "request".</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>return value (handle)</em></p>
<div class="paragraph">
<p>The call returns a JavaScript Iterable object representing the result set of the query. The query is streamed in batches as the iteration proceeds. The returned handle can be iterated using any standard JavaScript mechanism including for&#8230;&#8203;of loops.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>close() Method on handle object (return value)</em></p>
<div class="paragraph">
<p>This releases the resources held by the SQL++ query. If the query is still streaming results, the query is cancelled.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>Exceptions Thrown</em></p>
<div class="paragraph">
<p>The N1QL() function throws an exception if the underlying SQL++ query fails to parse or start executing. The returned Iterable handler throws an exception if the underlying SQL++ query fails after starting. The close() method on the iterable handle can throw an exception if underlying SQL++ query cancellation encounters an unexpected error.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="crc64_call"><a class="anchor" href="#crc64_call"></a>The crc64() Function Call</h3>
<div class="paragraph">
<p><em>crc64()</em>: This function calculates the CRC64 hash of an object using the ISO polynomial. The function
takes one parameter, the object to checksum, and this can be any JavaScript object that can be
encoded to JSON. The hash is returned as a string (because JavaScript numeric types offers only
53-bit precision). Note that the hash is sensitive to ordering of parameters in case of map
objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
    var crc_str = crc64(doc);
    /// code here ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>crc64</strong> function can be useful in cases like suppressing a duplicate mutation from the Sync Gateway (SG), when both the Sync Gateway &amp; Eventing are leveraging the same bucket. Basically, Sync Gateway updates metadata of the document within the bucket, which in turn generates an event for Eventing to process. Eventing can&#8217;t differentiate between events from Sync Gateway and other events (doc updates via SDK, SQL++, and others).  A workaround to this double mutation issue is possible via the <strong>crc64()</strong> function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
    // Ignore documents created by Sync Gateway
    if(meta.id.startsWith("_sync") == true) return;

    // Ignore documents whose body has not changed since we last saw it
    var prev_crc = checksum_bucket[meta.id];
    var curr_crc = crc64(doc);
    if (prev_crc === curr_crc) return;
    checksum_bucket[meta.id] = curr_crc;

   // Business logic goes in here
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if multiple Eventing Functions share the same Sync Gateway crc64() checksum documents, real mutations will be suppressed and missed. In this use case make the checksum documents unique to each Eventing Function, i.e. checksum_bucket["evfunc1:" + meta.id], checksum_bucket["evfunc2:" + meta.id], etc.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="timers_general"><a class="anchor" href="#timers_general"></a>Timers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Timers are asynchronous compute, which offers Eventing Functions the ability to execute in reference to wall-clock events, refer to the detailed <a href="eventing-timers.html" class="xref page">Timers</a> documentation.</p>
</div>
<div id="createtimer_call" class="paragraph">
<p><strong>The createTimer() Function Call</strong>: <em>createTimer(callback, date, reference, context)</em></p>
</div>
<div class="paragraph">
<p>To create a timer a callback or JavaScript function will be executed at or close to the desired date. The reference is an identifier for the timer scoped to an Eventing function and callback. The context must be serializable data that is available to the callback when the timer is fired.
For more information see <a href="eventing-timers.html#createtimer-function" class="xref page">createTimer function</a>.</p>
</div>
<div id="canceltimer_call" class="paragraph">
<p><strong>The cancelTimer() Function Call</strong>: cancelTimer(callback, reference)</p>
</div>
<div class="paragraph">
<p>To cancel a timer you can either by invoking <em>createTimer()</em> with the same reference of an existing timer or you can use the _cancelTimer() function.
For more information see <a href="eventing-timers.html#canceltimer-function" class="xref page">cancelTimer function</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="curl"><a class="anchor" href="#curl"></a>cURL</h2>
<div class="sectionbody">
<div id="curl_call" class="paragraph">
<p><strong>The curl() Function Call</strong>: response_object = curl(method, binding, [request_object])</p>
</div>
<div class="paragraph">
<p>The curl() function provides a way of interacting with external entities via a REST endpoint from Eventing Functions using either HTTP or HTTPS.
For more information see <a href="eventing-curl-spec.html" class="xref page">curl function</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="handler-signatures"><a class="anchor" href="#handler-signatures"></a>Handler Signatures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Eventing Service calls the following entry points or JavaScript functions on events (mutations or fired timers).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#onupdate_handler">OnUpdate Handler</a></p>
</li>
<li>
<p><a href="#ondelete_handler">OnDelete Handler</a></p>
</li>
<li>
<p><a href="#timer_callback_handler">Timer Callback Handler</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="onupdate_handler"><a class="anchor" href="#onupdate_handler"></a>OnUpdate Handler</h3>
<div class="paragraph">
<p>The <strong>OnUpdate</strong> handler gets called when a document is created or modified, e.g. Insert/Update. The entry point OnUpdate(doc,meta) listens to mutations (the creation or modification of documents) in the associated source Bucket.</p>
</div>
<div class="paragraph">
<p>In this handler the following limitations exist, both limitations arise due to KV engine design choices and may be revisited in the future:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a document is modified several times in a short duration, the calls may be coalesced into a single event due to deduplication.</p>
</li>
<li>
<p>It is not possible to distinguish between a Create and an Update operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A sample <strong>OnUpdate</strong> handler is displayed below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnUpdate(doc, meta) {
  if (doc.type === 'order' &amp;&amp; doc.value &gt; 5000) {
    // ‘phonverify’ is a bucket alias or binding to a keyspace.
    phoneverify[meta.id] = doc.customer;
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ondelete_handler"><a class="anchor" href="#ondelete_handler"></a>OnDelete Handler</h3>
<div class="paragraph">
<p>The <strong>OnDelete</strong> handler gets called when a document is deleted or removed due to an expiry.</p>
</div>
<div class="paragraph">
<p>The entry point OnDelete(meta,options) listens to mutations (deletions or expirations) in the associated source Bucket.  You can determine if the document was deleted or expired via inspecting the optional argument "options" (a JavaScript map object with a boolean property named 'expired').</p>
</div>
<div class="paragraph">
<p>In this handler the following limitation exists. This limitation arises due to KV engine design choices and may be revisited in the future:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it is not possible to get the value of the document that was just deleted or expired.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A sample <strong>OnDelete</strong> handler is displayed below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnDelete(meta,options) {
    if (options.expired) {
        log("Document expired", meta.id);
    } else {
        log("Document deleted", meta.id);
    }
    var addr = meta.id;
    var res = SELECT id from mybucket.myscope.orders WHERE shipaddr = $addr;
    for (var id of res) {
        log("Address invalidated for pending order: " + id);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the pre-6.6.0 argument syntax, OnDelete(meta), that lacks "options" is still fully supported, but you will not be able to differentiate deletion from expiration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function OnDelete(meta) {
    log("Document deleted or expired", meta.id);
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="timer_callback_handler"><a class="anchor" href="#timer_callback_handler"></a>Timer Callback Handler</h3>
<div class="paragraph">
<p>Timer callbacks are user defined JavaScript functions passed as the callback argument to the built-in createTimer(callback, date, reference, context) function call.</p>
</div>
<div class="paragraph">
<p>These handlers (JavaScript functions) are the entry points for the event when a timer (created by the specific Eventing Function) matures and fires.</p>
</div>
<div class="paragraph">
<p>A sample Timer Callback Handler, the user defined JavaScript function <strong>DocTimerCallback</strong>, is displayed below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">// Timer Callback Handler (user defined entry point)
function DocTimerCallback(context) {
	log("Timer fired running callback 'DocTimerCallback' with context: " + context);
}

// Insert/Update Handler or entry point
function OnUpdate(doc, meta) {
	// filter out docs of no interest.
	if (meta.id != 'make_timer:1') return;
	// Create a Date value 60 seconds from now
	var oneMinuteFromNow = new Date(); // Get current time &amp; add 60 sec. to it.
	oneMinuteFromNow.setSeconds(oneMinuteFromNow.getSeconds() + 60);
	// Create a doc to hold context to pass state to the callback function.
	var context = { docId: meta.id, random_text: "arbitrary text" };
	// Create a timer that will fire an event in the future.
	log("createTimer with callback 'DocTimerCallback'");
	createTimer(DocTimerCallback, oneMinuteFromNow, meta.id, context);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information see the <a href="#timers_general">Timers</a> section above and the detailed <a href="eventing-timers.html" class="xref page">Timers</a> documentation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reserved-words"><a class="anchor" href="#reserved-words"></a>Reserved Words</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reserved words are words that cannot be used in a Eventing Function as a variable name, function name, or as a property in the Eventing Function&#8217;s JavaScript code. The following table lists the reserved words that you must refrain from using as they are used by the transpiler to integrate with Couchbase&#8217;s query language, SQL++ with Eventing.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="4">SQL++ Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALTER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXECUTE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MERGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPDATE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXPLAIN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREPARE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPSERT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GRANT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RENAME</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REVOKE</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DROP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSERT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SELECT</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>What Happens If You Use a Reserved Word?</strong></p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you try to create a new Eventing Function with JavaScript code using a reserved word for variable names, for function names, and as a property binding value. All three cases generate a deployment error.</p>
</div>
<div class="paragraph">
<p>Reserved words as a variable name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function get_numip_first_3_octets(ip) {
    var grant = 0;
    if (ip) {
        var parts = ip.split('.');
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reserved words as a function name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function grant(ip) {
    var return_val = 0;
    if (ip) {
        var parts = ip.split('.');
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>During the Function deployment step, when the system validates the Eventing Function&#8217;s JavaScript code, it displays an error message such as the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Sample Error Message - Deployment failed: Syntax error (&lt;line and column numbers&gt;)
- grant is a reserved name in N1QLJs</pre>
</div>
</div>
<div class="paragraph">
<p>Reserved words as a property bindings value:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/reserved-words-7_0.png" alt="reserved words 7 0" width="642">
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.2"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
